# Lattice学习

学校有个作业，要求自选主题写论文。于是我选了格，早就想学但是一直懒得学。所以以下为该论文。由于论文格式的强制要求，以下内容均来自 https://eprint.iacr.org/2023/032.pdf ，不含任何我自己的想法（没错一点都不给写），但是我会将一些语句转化为自己的话语。是的这就是学术垃圾，甚至都不算论文，但是老师喜欢也没办法。原文写得很好，让我粗略地明白了格以及简单的用法。可惜没来得及看完，我只有两天时间写，只能粗略看了格的定义及几个简单用法。后面的我不一定会看了，真的难，定义和概念很多，即使看不懂，作为打CTF时的格cheat sheet绰绰有余

格可被描述为一个n维的，在 $R^n$ 下的离散加群。格以及其相关格基规约算法在数学以及密码学界应用众多，例如求解多项式的系数甚至攻击公钥加密体系。这些应用方式在基础的两个格问题“最短向量问题”（SVP）以及“最近向量问题”（CVP）上延伸，以下为格的三种应用方式：

1. “The problem we look at here is that of reconstructing the minimal polynomial of an algebraic number given an approximation of the number. This problem was shown to be solvable with lattice reduction in [KLL84].”(Joseph & Shaanan 13)

若F为一个域， $\alpha$ 为域中一个元素。 $\alpha$ 的极小多项式为满足 $\alpha$ 为F[x]中次数最小且为其根的首一多项式（monic polynomial）。假设已知某个三次极小多项式的根 $\alpha$ 得近似值为8.70997594，记为 $\beta$ 。为确保计算时使用的是整数格，可每项乘上 $10^8$ 。再构造一个4阶的格，按行排列构造出来的格基向量。执行LLL格基规约算法找到的短向量即为目标多项式的系数。

2. “The strategy [of solving low density knapsack problems] is to construct a lattice which contains a vector encoding the $e_i$ as a short vector.”(Joseph & Shaanan 18)

knapsack问题可概括为“从数集里选数字”。给定n个数字 $a_1...a_n$，以及目标整数s，在n个数字的子集内寻找和为s的那个子集。 $e_i$ 为用于标记某个数是否被选用，1表示该数被选用，0则与之相反。子集的和可以表示为 $e_i$ 与 $a_i$ 乘积之和。若按照特定方式构造格，使 $e_i$ 全体为格中的短向量，即可借助格基规约算法找到目标短向量，进而求解出 $e_i$ 。注意这种做法仅适用于density小于0.9408的knapsack，仅在某些特殊情况下可以处理density相比标准较高一点的knapsack问题。

3. "Coppersmith's method helps us to find all integer solutions x0 to the equation f(x0) = 0 (mod N) which satisfy |x0| < B for some bound B depending on N and d."(Joseph & Shaanan 15)

该方法的主要思想为构造另一个多项式h(x)，使得 $h(x_0)=0$ 。因为整数上的单变量多项式的高效求根算法有很多，所以转换多项式后求解h(x)的根不难，进而能获取原本多项式f(x)的解。注意到给多项式f加上任意倍的模数n后不会影响f模N下的根，所以可以构造这样一个格，使得格中的每个元素为与f模N下的根相同的多项式。关键点在于，满足这个条件的格中的多项式h(x)也会满足 $h(x_0)$ < N，即使在整数下同样满足 $h(x_0)=0$ 。如果某个多项式满足这样的需求，其系数不应太大。结合格中每个元素表示多项式的系数，符合格中短向量的定义，那么利用格基规约寻找目标短向量进而获取系数构造多项式的方法应该可行。

可以看出格的应用广泛，在解决部分已知的线性组合问题时有奇效。以上三种应用方式均在特定的数学或密码背景下将目标转换为基于格的问题，根据需求构造格后进行格基规约算法即可获得解。

评价：又短又垃圾。以下是作业之外自己的思考。拿第一种应用方式举例，就是那个根据根的估计值找多项式系数的例子。我一直苦于一个问题：构造格的时候用的是根，咋规约后变成系数了？最后看 https://www.ruanx.net/lattice-2/ 好像明白了一点。论文里说有关系 $10^8a_0 + ⌊10^8\beta⌋a_1 + ⌊10^8\beta^2⌋a_2 + ⌊10^8\beta^3⌋a3\approx 0$ ，这中间是否有线性关系？答案是有（具体参考论文，有图好看）。然后记住，表示格的那个矩阵只代表格的基，其整数倍的线性组合整体构成完整的格。因为我们的基构造得很好，有tB=x， $t=(a_0,a_1,a_2,1),x=(c,a_0,a_1,a_2)$ 。B是格基，肯定在格里；t用于决定格基之间如何进行线性组合，从而得到x。根据格的定义，x肯定是在格里的。构造基的时候用了那么长的向量做基向量，加上对题目背景的理解，x肯定长不到哪里去。总结一下，x在格里，估计还是最短向量，要找x，此时不用LLL还待何时？当然LLL不一定能找到，格基规约本质是把一堆乱七八糟的基向量尽量整得短点更正交一点，有些情况下规约后的基里正好就有最短向量

现在让我尝试回答那个让我困惑的问题时，我会这么说：不是根规约后变成系数，是构造了特殊的格使得系数以最短向量的形式存在于格中。反过来想就对劲了，拿根做基向量时系数为线性组合，某些情况下同样可以让原本的线性组合为基，于是根就成线性组合了（有些不对劲但是我先这么理解吧）

个人感觉t不一定在格里。在这些题目内t与x分量大量重复的原因是，格在成为格之前首先是个矩阵，符合矩阵与向量乘法。通常解题时格的构造方式都比较特殊，使一个向量乘上矩阵后向量的各个分量可在结果向量里找到。按照一般的线性代数，tB=x，想知道t或者x，总得知道另外的两个。但是格不一样，它让x为B的一部分，t与x基本重合。这样就能在仅知道B的情况下知道其他两个了

然后继续做题（ [any% ssg](https://github.com/AVDestroyer/CTF-Writeups/tree/main/lactf2024/any-percent-ssg) ）发现格不止于此。有时候要求的东西不一定要就是规约后的格基，也可以利用格基规约使格的结构好一点，后续爆破更有利

顺便在这里记一些没有例题，纯粹是见到的论文：
- [IMPROVED LOW-DENSITY SUBSET SUM ALGORITHMS](https://www.di.ens.fr/~fouque/ens-rennes/sac-LLL.pdf)