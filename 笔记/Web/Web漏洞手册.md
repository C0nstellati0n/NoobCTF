# Web漏洞手册

是时候整理一下笔记了，顺便写篇个人的"web参考手册"。以下仅为个人习惯

首先判断题目考点。第一步一般只能判断考点的大分类。题目要是给出了admin bot url，基本宣告了这题为xss等需要外部介入的题。然后我会看一眼源码，根据语言继续细分

然后看一眼网站。当然还是根据情况判断。要是源码很少我就直接看源码了；要是源码很多我会稍微瞄一眼然后看网站。有些时候虽然源码很多，但实际网站上的操作不多。可根据能执行的操作定位源码的重要部分

最后就是找bug了。一定要把源码的每个部分都看一眼，包括dockerfile和使用的dependencies。注意安装的软件、依赖项版本。一般都会安最新的或者稳定版，如果刻意安装了某个特定版本，最好搜一下`软件/依赖项名 版本`，看看有没有已知漏洞。就算没有也不要掉以轻心。有些时候某个库单独没任何漏洞，但存在可被其他库/代码逻辑利用的gadget

如果是那种脚本题（没有bug，只需按照源码的指示即可得到flag），直接莽吧，chatgpt对这种题有奇效

这边按照源码语言/漏洞类型整理一下我所见过的漏洞。我会在这里记录漏洞的简单描述、关键词和特征。若在题目里看到类似该特征的代码/内容可以考虑此漏洞（本人才疏学浅，总结的特征不完全准确。拥有该特征并不完全等于有此漏洞）。确认是该漏洞后在Web笔记处ctrl+f搜索漏洞关键词就能拿到该漏洞的相关例题。注意同一关键词可能搜出来不同语言里的漏洞，请自行根据目前所在语言/漏洞项过滤

## Python

### Flask

1. 模板注入
- flask渲染模板时可使用表达式，语法为`{{expression}}`。若没有正确过滤用户输入内容，直接将用户输入内容插入template并渲染，攻击者可利用此语法获取rce
- 特征
  - 网站会回显用户输入内容。此时可将输入内容换为`{{7*7}}`，返回49则确定漏洞
  - 无过滤直接拼接用户输入至某个字符串并将该字符串传入`render_template_string`函数
- 关键词
  - 模板注入
  - ssti
2. Werkzeug密码破解
- flask内部使用Werkzeug，而Werkzeug使用的密码格式可以爆破。不到最后一步不要考虑此漏洞
- 特征
  - 可以获取网站内部存储的Werkzeug密码。密码以`pbkdf2:sha256`开头
  - 有些题目会特别提供一个wordlist
- 关键词：Werkzeug