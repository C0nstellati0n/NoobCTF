# Ezfactor

看不起脚本小子是吧？没错我也看不起我自己。

题目场景需要nc，也给了源码。但是我没有下载保存，解出题以后也没发重新查看附件了，所以……吐槽一句为啥不能重复下载已解出题的附件啊？

剧透一下源码的关键点：在完成要求的条件后会随机生成一个Q，p和flag固定，给出密文和n，e是65537。这个p可不兴固定啊，虽然q随机且有2048位，但是pq1=n1，pq2=n2，那只要找到n1和n2的最大公因数不就找到p，进而找到q了吗？是不是很简单？我最开始还没想到，还是搜了才知道的（数学界的地板砖）

nc就可以知道需要通过的条件是啥了。

- [+] I have two prime number A,B s.t. A>=B and A+B == 4571029187373177959784634830776
<br>[+] Plz tell me A=

A大于等于B，且都是质数，A+B等于4571029187373177959784634830776。没想到吧连这个我都要去搜。

```python
from Crypto.Util.number import isPrime
n=4280255672310067060716913265336
for i in range(1,n):
    if isPrime(i) and isPrime(n-i):
        print(i,n-i)
        break
```

谢谢你Crypto。注意满足条件的A和B有很多组，我们只要一组就得了。这题的难点在于怎么判断是质数，可是咱们有Crypto啊！剩下的也没啥说的了，循环增加i作为A，那B肯定就是n-i了。

找到了一组解后就能得到n1了。我们还需要n2，所以要再来一次。得到两个n后就可以开始解密了。

```python
from Crypto.Util.number import long_to_bytes,inverse,GCD
n1=0x7ac54295c9482316c8f2afad6ba1d0d647057f6a2b01ca187e60a67311af022c947b6f812e37dc2a95b093801d9235d37160a5975ec95ef3a7e7ffcbbcf7eb11f67e8f2b6ee8b8053c8f6e75997421f6a692ad92e4d73c4332f0a562df8e33ec495d1411fbed35244efcc05d6c6117edd82c22ba08f9d54154610b2c9f512530f43d952889228e785fd573ac36ecdcfedac4336d3bca6e82c80584a676b1b24e0baa1ed6acb62233edf6f63d02b01c96c13dc1cd7f43a7da405f0d9207ec29444503d2ee04d19fe129bb03258e1a4eedf3b563845826c239b4c99fb23873a2774b472642e5acefb3cb82f423b207399e708723e4d223dfd58edbd368423ee1a9a58f1c9dad18189bc7aa1992506df832228dd1fd3f098a01917cc97d32dc967acf52732f8835b5837e9937709a79937cdcce50d30194371313fd867dc7ddedc599b46ebe94b07d8e857a61f67ade11823a772fe2f3aca5341e9d8a118dacab26c22d230d19b4467b84d296380dc5aed59c83d1328fd5e169c478f0bf1164fa20b9952f7100e9abb39417b8ee45b795bca156561a97e7287f66e04745b2e5f0a44dbfe923c7fe8b5f49f4bdbc0d5ecec852ad19ce335149801b6cf58c9c7198949145841d84eba0a7693f15ee02f56a2eca147c49f1f5a597b8551175bc3b8b51d1ace09f00a8f2010d1bc68b7eb86cf84bd5439354cda1ada8f43e4761a4f5f1
n2=0x74760c2ab49af21a78b4879d7f2b68f1338c6fee21bbd7712e40ea7414005a883b49735951fe5d12d1bef19e542fce6f1a362be7b78654fad59053eeba2210fb1ba56b875e0e36b565b0416d7269df9c597ab4cb1dcf653297223149ec19c3495a4c8945706614210fa8dfb87ae87ca288dd759a77ed47224c9b1eae696a2b8df9b19119cb9889a7666ec717b41e174ec5a7b91c45ecbd19d98c90b05f297b87481032bb71348ca9b95423faabd91fc5eb748dc4f5d7e472a32f502376e5a8cb27a504c20977b170d2925e065eacfa95e771eaf316177596d6b9d246dab1e21b94c37c99a3bcbeb93fa9c5365df3de85ac8ad03c52dda3baaa7ccd4bc24182b537f440399edb3775f9eac36d1b1bc7f1fff7898cd6e06cbc82dacab406c367f2e3be415ad2fc29b2e345405acda6d5e9ba059fa35b3a794d5a106ed6d9d25610a4e6d37344231e377701cf9f56ca2c5b7165b1a12282cbce3e4f1c52c5f421d1cb8045a197326a777e6e7eaa7074e20b4f9051adeb8e9f9513edbcfb6e44081a1cccac7f3f4be908ee327b7e090f98a46fff43ca1d3fda5209c6a478d894f8862bb7285fce72f228cf92aa214bbeb0e3ce651f4ee1c06822a1bafbb0b54c3301e5e7edae1e178c0f1e39a358481f71910b03a4648b55d42683cb62ebeeb613a235aa9461a2673e375dbaeb3fb1211fea42deaaf80f528b9371ec4a314a6cb1ff
e=65537
ciphertext=0x5b85bfa56a2a4582397437613e92d91537791a4651a524be42e577deedb1fc229e2db5212cfede07ba09f38db771cc829cca4e0ce8c6bafabac0645735dc210d39aea80433e1582971c4a84b59586a16314cb2c84b0e93ba2c0c727fdbc1377117f3581c2891c3581be1f440c5c3912e438bf56ee02f052e38911e907669621c4416c1a1c7470459077b56ed95aed12d02a82a26c31a8f21e2979404a1546e03f1ce0524e6755cdb49da9f13f1890d7fcbcb491896ac7bebd306c6cac6573765fb21317a40954d617a5d77ccd132b0ab509eb7b3677343d4b9ab845e26a654f432093c1005cc90053ffca69c269ce6a834704eb7efa001f7053a4f090a2b209502815f8a514cd5523c4dafe9df6d3fc57d09c975749a47b4ded064a2f4b009dc33a72a48e90d9449b9176d3762e2bbe8c88f695a9f50f7d51c22ec78719d19f0a6cd5edd559b997ea82384760135f7cdb0089e927455ee727b887a130b58389626b53db56d41cb11636b25faecc21e6f12489239e56e57b5602ed35da1d49171731b96e30c758ac24874b6ed8d2b6039342d1de97dc47ef6419a2ff011f3eefc55c6bff54ffa4c8685b9a73685c79fa35c40beb5a0ae3beb189a0dfcc1a385d7677c7646204a7dd69c58636454aea86af581c6449b24f92b056e41eafa224258080e28b945fd0efe96a02e7cc77ac97d4f27a445b5bcc4ebc041e4e2ccf1d870
common_prime=GCD(n1,n2)
p=n1//common_prime
toitent=(p-1)*(common_prime-1)
d=inverse(e,toitent)
plaintext=long_to_bytes(pow(ciphertext,d,n1))
print(f"明文为: {plaintext}")
```

Crypto里还有求逆元和最大公因数的函数。太快乐了，当个乘凉的后人真的太快乐了。

- ### Flag
  > moectf{1t5_d4nger0us_t0_u5e_the_same_P_repeated1y}